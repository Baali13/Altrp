{"version":3,"sources":["widgets/Table/custom.js","hooks/useWidgetSettings.js"],"names":["CustomTableSettings","useWidgetSettings","columns","setColumns","rows","setRows","useState","columnName","setColumnName","addColumn","useCallback","addRow","e","preventDefault","formData","FormData","target","newRow","forEach","value","key","reset","removeColumn","filter","_","index","Group","Label","placeholder","onKeyPress","onChange","Append","variant","onClick","onSubmit","className","map","item","name","size","type","property","defaultValue","dispatch","useDispatch","sections","useSelector","present","selectedWidget","sectionIndex","columnIndex","rowIndex","isNumber","widget","settings","mutate","get","params","newSettings","set","changeWidget"],"mappings":"yMAkFeA,UA7Ea,WAAM,MAEFC,YAAkB,UAAW,IAF3B,mBAEzBC,EAFyB,KAEhBC,EAFgB,OAGRF,YAAkB,OAAQ,IAHlB,mBAGzBG,EAHyB,KAGnBC,EAHmB,OAMIC,mBAAS,IANb,mBAMzBC,EANyB,KAMbC,EANa,KAS1BC,EAAYC,uBAAY,WAC5BP,EAAW,GAAD,mBAAKD,GAAL,CAAcK,KACxBC,EAAc,MACb,CAACD,EAAYL,EAASC,IAGnBQ,EAASD,uBACb,SAACE,GACCA,EAAEC,iBACF,IAAMC,EAAW,IAAIC,SAASH,EAAEI,QAC5BC,EAAS,GACbH,EAASI,SAAQ,SAACC,EAAOC,GACvBH,EAAOG,GAAOD,KAEhBd,EAAQ,GAAD,mBAAKD,GAAL,CAAWa,KAClBL,EAAEI,OAAOK,UAEX,CAACjB,EAAMC,IAIHiB,EAAeZ,uBACnB,SAACU,GACCjB,EAAWD,EAAQqB,QAAO,SAACC,EAAGC,GAAJ,OAAcA,IAAUL,QAEpD,CAAClB,EAASC,IAGZ,OACE,oCACE,kBAAC,IAAKuB,MAAN,KACE,kBAAC,IAAKC,MAAN,mDACA,kBAAC,IAAD,KACE,kBAAC,IAAD,CACEC,YAAY,gEACZT,MAAOZ,EACPsB,WAAY,SAACjB,GAAD,MAAiB,UAAVA,EAAEQ,KAAmBX,KACxCqB,SAAU,SAAClB,GAAD,OAAOJ,EAAcI,EAAEI,OAAOG,UAE1C,kBAAC,IAAWY,OAAZ,KACE,kBAAC,IAAD,CAAQC,QAAQ,UAAUC,QAASxB,GAAnC,QAMN,kBAAC,IAAD,CAAMyB,SAAUvB,EAAQwB,UAAU,QAC/BjC,EAAQkC,KAAI,SAACC,EAAMjB,GAAP,OACX,kBAAC,IAAKM,MAAN,CAAYN,IAAKA,GACf,kBAAC,IAAKO,MAAN,KAAaU,GACb,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAaC,KAAMD,IACnB,kBAAC,IAAWN,OAAZ,KACE,kBAAC,IAAD,CAAQC,QAAQ,SAASC,QAAS,kBAAMX,EAAaF,KAArD,WAOR,kBAAC,IAAD,CAAQmB,KAAK,KAAKP,QAAQ,UAAUQ,KAAK,UAAzC,6F,iCC1ER,6CA4CevC,IAvCW,SAACwC,EAAUC,GACnC,IAAMC,EAAWC,cAEXC,EAAWC,aAAY,qBAAGD,SAAwBE,QAAQF,YAHZ,EAMJC,aAC9C,qBAAGD,SAAwBE,QAAQC,kBAD7BC,EAN4C,EAM5CA,aAAcC,EAN8B,EAM9BA,YAAaC,EANiB,EAMjBA,SAKnC,IAAKC,YAASH,GAAe,MAAO,CAAC,GAAI,cAGzC,IAAMI,EAASR,EAASI,GAAc/C,QAAQgD,GAAaC,GAEvDG,EAAW,GAGXD,GAAUZ,EAEZa,EAAWC,IAAOC,IAAIH,EAAOI,OAAQhB,IAAaC,EACzCW,IACTC,EAAWD,EAAOI,QAapB,MAAO,CAACH,EATY,SAACG,GACnB,GAAIhB,EAAU,CACZ,IAAMiB,EAAcH,IAAOI,IAAIN,EAAOI,OAAQhB,EAAUgB,GACxDd,EAASiB,YAAaF,SAEtBf,EAASiB,YAAaH","file":"static/js/17.638d8c81.chunk.js","sourcesContent":["import React, { useState, useCallback } from \"react\";\nimport { Form, FormControl, Button, InputGroup } from \"react-bootstrap\";\n\nimport useWidgetSettings from \"hooks/useWidgetSettings\";\n\nconst CustomTableSettings = () => {\n  // Список колонок\n  const [columns, setColumns] = useWidgetSettings(\"columns\", []);\n  const [rows, setRows] = useWidgetSettings(\"rows\", []);\n\n  // Временное название новой колонки\n  const [columnName, setColumnName] = useState(\"\");\n\n  // Добавляем новую колонку\n  const addColumn = useCallback(() => {\n    setColumns([...columns, columnName]);\n    setColumnName(\"\");\n  }, [columnName, columns, setColumns]);\n\n  // Добавляем новую запись\n  const addRow = useCallback(\n    (e) => {\n      e.preventDefault();\n      const formData = new FormData(e.target);\n      let newRow = {};\n      formData.forEach((value, key) => {\n        newRow[key] = value;\n      });\n      setRows([...rows, newRow]);\n      e.target.reset();\n    },\n    [rows, setRows]\n  );\n\n  // Удаляем колонку\n  const removeColumn = useCallback(\n    (key) => {\n      setColumns(columns.filter((_, index) => index !== key));\n    },\n    [columns, setColumns]\n  );\n\n  return (\n    <>\n      <Form.Group>\n        <Form.Label>Колонки</Form.Label>\n        <InputGroup>\n          <FormControl\n            placeholder=\"Имя колонки\"\n            value={columnName}\n            onKeyPress={(e) => e.key === \"Enter\" && addColumn()}\n            onChange={(e) => setColumnName(e.target.value)}\n          />\n          <InputGroup.Append>\n            <Button variant=\"primary\" onClick={addColumn}>\n              +\n            </Button>\n          </InputGroup.Append>\n        </InputGroup>\n      </Form.Group>\n      <Form onSubmit={addRow} className=\"mb-3\">\n        {columns.map((item, key) => (\n          <Form.Group key={key}>\n            <Form.Label>{item}</Form.Label>\n            <InputGroup>\n              <FormControl name={item} />\n              <InputGroup.Append>\n                <Button variant=\"danger\" onClick={() => removeColumn(key)}>\n                  -\n                </Button>\n              </InputGroup.Append>\n            </InputGroup>\n          </Form.Group>\n        ))}\n        <Button size=\"sm\" variant=\"success\" type=\"submit\">\n          Добавить запись\n        </Button>\n      </Form>\n    </>\n  );\n};\n\nexport default CustomTableSettings;\n","import mutate from \"dot-prop-immutable\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { changeWidget } from \"../store/sections/actions\";\nimport { isNumber } from \"../helpers/number\";\n\nconst useWidgetSettings = (property, defaultValue) => {\n  const dispatch = useDispatch();\n  // Получаем секции\n  const sections = useSelector(({ sections }) => sections.present.sections);\n\n  // Получаем позицию выбранного виджета в массиве\n  const { sectionIndex, columnIndex, rowIndex } = useSelector(\n    ({ sections }) => sections.present.selectedWidget\n  );\n\n  // Если виджет не выбран то выводим undefined\n  if (!isNumber(sectionIndex)) return [{}, () => {}];\n\n  // Получаем данные виджета\n  const widget = sections[sectionIndex].columns[columnIndex][rowIndex];\n\n  let settings = {};\n\n  // Если указано конкретное свойство, возвращаем только его\n  if (widget && property) {\n    //console.log(\"widget.params\", widget.params);\n    settings = mutate.get(widget.params, property) || defaultValue;\n  } else if (widget) {\n    settings = widget.params;\n  }\n\n  // Записываем новые настройки\n  const setSettings = (params) => {\n    if (property) {\n      const newSettings = mutate.set(widget.params, property, params);\n      dispatch(changeWidget(newSettings));\n    } else {\n      dispatch(changeWidget(params));\n    }\n  };\n\n  return [settings, setSettings];\n};\n\nexport default useWidgetSettings;\n"],"sourceRoot":""}