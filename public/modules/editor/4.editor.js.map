{"version":3,"sources":["webpack:///./resources/modules/editor/src/js/classes/modules/BaseModule.js","webpack:///./resources/modules/editor/src/js/classes/modules/ElementsFactory.js","webpack:///./resources/modules/editor/src/js/classes/Resource.js","webpack:///./resources/modules/editor/src/js/classes/modules/SaveImportModule.js","webpack:///./resources/modules/editor/src/js/classes/modules/SettingsChangeModule.js","webpack:///./resources/modules/editor/src/js/classes/modules/TemplateSettingsChangeModule.js","webpack:///./resources/modules/editor/src/js/classes/modules/TemplateDataStorage.js","webpack:///./resources/modules/editor/src/js/classes/Modules.js","webpack:///./resources/modules/editor/src/js/components/WidgetIcon.js","webpack:///./resources/modules/editor/src/js/components/WidgetsPanel.js","webpack:///./resources/modules/editor/src/js/components/SettingSection.js","webpack:///./resources/modules/editor/src/js/components/PanelTabContent.js","webpack:///./resources/modules/editor/src/js/components/SettingsPanel.js","webpack:///./resources/modules/editor/src/js/components/EditorWindow.js","webpack:///./resources/modules/editor/src/js/components/HistoryPanel.js","webpack:///./resources/modules/editor/src/js/components/UpdateButton.js","webpack:///./resources/modules/editor/src/js/classes/modules/AssetsBrowser.js","webpack:///./resources/modules/editor/src/Editor.js"],"names":["BaseModule","modules","this","ElementsFactory","object","parent","children","elementsManager","window","element","getElementClass","name","length","child","checkElementExists","push","parseData","id","settings","target","newElement","_duplicateElement","insertNewChildAfter","getId","templateDataStorage","getEditor","elementsIds","_","union","getIds","getName","newChildren","map","childrenItem","newChild","setParent","component","setChildren","cloneDeep","Resource","data","route","url","fetch","method","headers","then","res","ok","Promise","reject","text","status","json","_token","options","body","JSON","stringify","files","fileType","String","Math","random","slice","formData","FormData","console","log","i","size","type","indexOf","append","SaveImportModule","resource","template_id","getTemplateId","store","dispatch","changeTemplateStatus","CONSTANTS","TEMPLATE_SAVING","get","templateData","parse","parsedData","elementsFactory","replaceAll","setTitle","title","setName","endLoading","TEMPLATE_UPDATED","err","error","getTemplateDataForSave","put","SettingsChangeModule","TemplateSettingsChangeModule","TemplateDataStorage","RootElement","rootElement","setCurrentRootElement","toObject","getTemplateData","currentElement","setCurrentElement","BaseElement","elementName","newSection","Section","newColumn","Column","newWidget","appendWidget","appendColumn","appendNewSection","TEMPLATE_NEED_UPDATE","showSettingsPanel","Modules","editor","saveImportModule","settingsChangeModule","templateSettingsChangeModule","load","WidgetIcon","props","state","onDragStart","bind","e","startDrag","dataTransfer","effectAllowed","setData","className","draggable","React","createElement","getIconComponent","height","getTitle","Component","WidgetsPanel","widgets","getWidgetsList","widget","key","SettingSection","open","toggle","setState","controllers","controls","sectionClasses","onClick","label","controller","ControllerComponent","controllersManager","getController","controlId","Controller","PanelTabContent","sections","autoHide","autoHideTimeout","autoHideDuration","section","idx","sectionId","SettingsPanel","activeTab","getControls","contentTabClasses","TAB_CONTENT","styleTabClasses","TAB_STYLE","advancedTabClasses","TAB_ADVANCED","setActiveTab","connect","EditorWindow","src","UpdateButton","saveTemplate","buttonClasses","templateStatus","AssetsBrowser","tabClick","toggleBrowser","selectAsset","chooseAsset","tabs","assets","getAssets","selectedAsset","mediaAssets","mediaResource","getAll","tab","iconsManager","getIconsList","currentTarget","dataset","assetname","assetsToggle","asset","forEach","item","onChoose","classes","active","tabClasses","data-tab","AssetContent","assetProps","iconComponent","width","filename","assetType","data-assetname","_export","assetsManagerSettings","altrpEditor","activePanel","openPageSettings","showWidgetsPanel","onDragEnd","subscribe","getState","loaded","contextMenu","hideAll","draggableElement","elementDrag","stopDrag","initModules","settingsActive","templateClasses","getType","viewBox"],"mappings":"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","file":"4.editor.js","sourcesContent":["\r\n/**\r\n * @property {Modules} modules\r\n * */\r\nclass BaseModule {\r\n  /**\r\n   * @param {Modules} modules\r\n   * */\r\n  constructor(modules) {\r\n    this.modules = modules;\r\n  }\r\n}\r\n\r\nexport default BaseModule;","import BaseModule from './BaseModule';\r\nimport {getEditor} from \"../../helpers\";\r\n\r\nclass ElementsFactory extends BaseModule{\r\n  parseData(object, parent){\r\n    let children = [];\r\n    const elementsManager = window.elementsManager;\r\n    /**\r\n     * @member {BaseElement} element\r\n     * */\r\n    let element = new (elementsManager.getElementClass(object.name));\r\n    if( object.children && object.children.length ){\r\n      for( let child of object.children){\r\n        elementsManager.checkElementExists(child.name) ?\r\n          children.push( this.parseData(child, element) ) : '';\r\n      }\r\n    }\r\n    element.id = object.id;\r\n    element.children = children;\r\n    /**\r\n     * Если настройки пустый то с сервера приходит пустой массив -- меняем на пустой объект\r\n     * */\r\n    element.settings = (object.settings.length === 0) ? {} : object.settings;\r\n\r\n    if(parent){\r\n      element.parent = parent;\r\n    }\r\n    return element;\r\n  }\r\n\r\n  /**\r\n   * @param {BaseElement} element\r\n   * @param {BaseElement} target\r\n   * @return{BaseElement}\r\n   * */\r\n  duplicateElement(element, target){\r\n\r\n    let newElement = this._duplicateElement(element);\r\n    target.insertNewChildAfter(element.getId(), newElement);\r\n    /**\r\n     * @member {TemplateDataStorage} templateDataStorage\r\n     * */\r\n    let templateDataStorage = getEditor().modules.templateDataStorage;\r\n    templateDataStorage.elementsIds = _.union(templateDataStorage.elementsIds, newElement.getIds());\r\n    return newElement;\r\n  }\r\n  /**\r\n   * @param {BaseElement} element\r\n   * */\r\n  _duplicateElement(element){\r\n    /**\r\n     * @member {BaseElement} newElement\r\n     * */\r\n    let newElement = new (elementsManager.getElementClass(element.getName()));\r\n    let newChildren = [];\r\n    element.children.map((childrenItem)=>{\r\n      let newChild = this._duplicateElement(childrenItem);\r\n      newChild.setParent(newElement);\r\n      newChildren.push(newChild);\r\n    });\r\n    newElement.component = new\r\n    newElement.setChildren(newChildren);\r\n    newElement.settings = _.cloneDeep(element.settings);\r\n    newElement.children = newChildren;\r\n    return newElement;\r\n  }\r\n}\r\n\r\nexport default ElementsFactory;","/**\r\n * @class\r\n * */\r\n\r\nexport const MAX_FILE_SIZE = 10485760;\r\nclass Resource {\r\n\r\n\r\n  /**\r\n   * @member {Object} routes\r\n   * @member {string} routes.get\r\n   * @member {string} routes.post\r\n   * @member {string} routes.create\r\n   * @member {string} routes.getAll\r\n   */\r\n  constructor(data){\r\n\r\n    this.route = data.route;\r\n    if(! this.route){\r\n      throw 'Нужен route';\r\n    }\r\n\r\n  }\r\n  /**\r\n   * @return {Promise}\r\n   * */\r\n  get(id){\r\n    if(! id){\r\n      throw 'Get only by \"id\"';\r\n    }\r\n\r\n    let options = {\r\n      method: 'get',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n    };\r\n\r\n    let url = this.route + '/' + id;\r\n    return fetch(url, options).then(res => {\r\n      if(res.ok === false){\r\n        return Promise.reject(res.text(), res.status);\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n  /**\r\n   * @return {Promise}\r\n   * */\r\n  getAll(){\r\n\r\n    let options = {\r\n      method: 'get',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n    };\r\n\r\n    let url = this.route;\r\n    return fetch(url, options).then(res => {\r\n      if(res.ok === false){\r\n        return Promise.reject(res.text(), res.status);\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param {any} data\r\n   * @param {object | null} headers\r\n   * @return {Promise}\r\n   * */\r\n  post(data = {}, headers){\r\n    data._token = _token;\r\n    headers = headers || {\r\n      'Content-Type': 'application/json'\r\n    };\r\n    let options = {\r\n      method: 'POST',\r\n      body: JSON.stringify(data),\r\n      headers,\r\n    };\r\n    return fetch(this.route, options).then(res => {\r\n      if(res.ok === false){\r\n        return Promise.reject(res.text(), res.status);\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n  /**\r\n   * @param {FileList} files\r\n   * @param {string} fileType\r\n   * @return {Promise}\r\n   * */\r\n  postFiles(files, fileType){\r\n    // data._token = _token;\r\n    let boundary = String(Math.random()).slice(2);\r\n    fileType = fileType || 'image';\r\n    let headers = {\r\n      'X-CSRF-TOKEN': _token,\r\n      // 'Content-Type': 'multipart/form-data; boundary=' + boundary\r\n    };\r\n    let formData = new FormData();\r\n    console.log(files);\r\n    for (let i = 0; i < files.length; i++) {\r\n      if(files[i].size > MAX_FILE_SIZE || files[i].type.indexOf(fileType) !== 0){\r\n        console.log(files[i]);\r\n        continue;\r\n      }\r\n      formData.append(`files[${i}]`, files[i]);\r\n    }\r\n    let options = {\r\n      method: 'POST',\r\n      body: formData,\r\n      headers,\r\n    };\r\n    return fetch(this.route, options).then(res => {\r\n      if(res.ok === false){\r\n        return Promise.reject(res.text(), res.status);\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @return {Promise}\r\n   * */\r\n  put(id, data){\r\n    data._token = _token;\r\n    let options = {\r\n      method: 'put',\r\n      body: JSON.stringify(data),\r\n      headers: {\r\n        'X-CSRF-TOKEN': _token,\r\n        'Content-Type': 'application/json'\r\n      },\r\n    };\r\n    let url = this.route + '/' + id;\r\n    return fetch(url, options).then(res => {\r\n      if(res.ok === false){\r\n        return Promise.reject(res.text(), res.status);\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n  /**\r\n   * @return {Promise}\r\n   * */\r\n  delete(id){\r\n\r\n    let options = {\r\n      method: 'delete',\r\n      headers: {\r\n        'X-CSRF-TOKEN': _token,\r\n        'Content-Type': 'application/json'\r\n      },\r\n    };\r\n    let url = this.route + '/' + id;\r\n    return fetch(url, options).then(res => {\r\n      if(res.ok === false){\r\n        return Promise.reject(res.text(), res.status);\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n  /**\r\n   * @return {Promise}\r\n   * */\r\n  getOptions(){\r\n\r\n    let options = {\r\n      method: 'get',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n    };\r\n    let url = this.route + '/options';\r\n    return fetch(url, options).then(res => {\r\n      if(res.ok === false){\r\n        return Promise.reject(res.text(), res.status);\r\n      }\r\n      return res.json()\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport default Resource;","import BaseModule from \"./BaseModule\";\r\nimport Resource from \"../Resource\";\r\nimport {CONSTANTS, getEditor, getTemplateId} from \"../../helpers\";\r\nimport RootElement from \"../elements/RootElement\";\r\nimport store from \"../../store/store\";\r\nimport {changeTemplateStatus} from \"../../store/template-status/actions\";\r\n\r\nclass SaveImportModule extends BaseModule{\r\n\r\n  constructor(modules){\r\n    super(modules);\r\n\r\n    this.resource = new Resource({\r\n      route: '/admin/ajax/templates',\r\n    });\r\n  }\r\n\r\n  load(){\r\n    this.template_id = getTemplateId();\r\n    // console.log(this.template_id);\r\n    store.dispatch(changeTemplateStatus(CONSTANTS.TEMPLATE_SAVING));\r\n    if(this.template_id){\r\n      let res = this.resource.get(this.template_id).then(templateData => {\r\n        let data = JSON.parse(templateData.data);\r\n        let parsedData = this.modules.elementsFactory.parseData(data);\r\n        let templateDataStorage = getEditor().modules.templateDataStorage;\r\n        templateDataStorage.replaceAll(parsedData);\r\n        templateDataStorage.setTitle(templateData.title);\r\n        templateDataStorage.setName(templateData.name);\r\n        getEditor().endLoading();\r\n        store.dispatch(changeTemplateStatus(CONSTANTS.TEMPLATE_UPDATED));\r\n      }).catch(err=>{\r\n        console.error(err);\r\n        store.dispatch(changeTemplateStatus(CONSTANTS.TEMPLATE_UPDATED));\r\n      });\r\n    } else {\r\n\r\n    }\r\n  }\r\n\r\n  saveTemplate(){\r\n    store.dispatch(changeTemplateStatus(CONSTANTS.TEMPLATE_SAVING));\r\n    let templateData = getEditor().modules.templateDataStorage.getTemplateDataForSave();\r\n    this.resource.put(this.template_id, templateData).then(res=>{\r\n      store.dispatch(changeTemplateStatus(CONSTANTS.TEMPLATE_UPDATED));\r\n    }).catch(err=>{\r\n      console.error(err);\r\n      store.dispatch(changeTemplateStatus(CONSTANTS.TEMPLATE_UPDATED));\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport default SaveImportModule;","class SettingsChangeModule {\r\n\r\n}\r\nexport default SettingsChangeModule;","class TemplateSettingsChangeModule {\r\n\r\n}\r\nexport default TemplateSettingsChangeModule;","import RootElement from \"../elements/RootElement\";\r\nimport {CONSTANTS, getEditor, getTemplateId} from \"../../helpers\";\r\nimport BaseModule from \"./BaseModule\";\r\nimport store from '../../store/store';\r\nimport {setCurrentElement, SET_CURRENT_ELEMENT} from '../../store/current-element/actions'\r\nimport BaseElement from \"../elements/BaseElement\";\r\nimport Section from \"../elements/Section\";\r\nimport Column from \"../elements/Column\";\r\nimport {changeTemplateStatus} from \"../../store/template-status/actions\";\r\n\r\nclass TemplateDataStorage extends BaseModule{\r\n\r\n  constructor(modules){\r\n    super(modules);\r\n    this.elementsIds = [];\r\n  }\r\n\r\n  replaceAll(element) {\r\n    if(! element instanceof RootElement ){\r\n      throw 'Expect Root Element as root element;)';\r\n    }\r\n    this.rootElement = element;\r\n    this.elementsIds = element.getIds();\r\n    this.setCurrentRootElement();\r\n  }\r\n\r\n  getTemplateData() {\r\n    return this.rootElement.toObject();\r\n  }\r\n  getTemplateDataForSave(){\r\n    let data = {};\r\n\r\n    data.data = this.getTemplateData();\r\n    data.title = this.title || 'testtitle';\r\n    data.name = this.name || 'testname';\r\n    console.log(this);\r\n    return data;\r\n  }\r\n\r\n  setTitle(title){\r\n    this.title = title;\r\n  }\r\n\r\n\r\n  setName(name){\r\n    this.name = name;\r\n  }\r\n\r\n  setCurrentRootElement(){\r\n    this.currentElement = this.rootElement;\r\n    store.dispatch(setCurrentElement(this.currentElement));\r\n    return this.currentElement;\r\n  }\r\n\r\n  setCurrentElement(element){\r\n    if(! element instanceof BaseElement){\r\n      throw 'Only Base Element Can Be Set as Default'\r\n    }\r\n    this.currentElement = element;\r\n    store.dispatch(setCurrentElement(element));\r\n  }\r\n\r\n  getCurrentElement(){\r\n    if(!this.currentElement){\r\n      return this.setCurrentRootElement();\r\n    }\r\n    return this.currentElement;\r\n  }\r\n\r\n  getRootElement(){\r\n    return this.rootElement\r\n  }\r\n\r\n  addWidgetInSection(elementName){\r\n    let newSection = new Section();\r\n    this.elementsIds.push(newSection.getId());\r\n\r\n    let newColumn = new Column();\r\n    this.elementsIds.push(newColumn.getId());\r\n\r\n    let newWidget = new (window.elementsManager.getElementClass(elementName));\r\n    this.elementsIds.push(newWidget.getId());\r\n\r\n    newColumn.appendWidget(newWidget);\r\n    newSection.appendColumn(newColumn);\r\n    this.rootElement.appendNewSection(newSection);\r\n    this.setCurrentElement(newWidget);\r\n    store.dispatch(changeTemplateStatus(CONSTANTS.TEMPLATE_NEED_UPDATE));\r\n    getEditor().showSettingsPanel();\r\n  }\r\n\r\n}\r\n\r\nexport default TemplateDataStorage;","import ElementsFactory from './modules/ElementsFactory';\r\nimport SaveImportModule from \"./modules/SaveImportModule\";\r\nimport SettingsChangeModule from \"./modules/SettingsChangeModule\";\r\nimport TemplateSettingsChangeModule from \"./modules/TemplateSettingsChangeModule\";\r\nimport TemplateDataStorage from \"./modules/TemplateDataStorage\";\r\n\r\nclass Modules {\r\n  /**\r\n   * @param {Editor} editor\r\n   * */\r\n  constructor(editor){\r\n    this.elementsFactory = new ElementsFactory(this);\r\n    this.saveImportModule = new SaveImportModule(this);\r\n    this.settingsChangeModule = new SettingsChangeModule(this);\r\n    this.templateSettingsChangeModule = new  TemplateSettingsChangeModule(this);\r\n    this.templateDataStorage = new TemplateDataStorage(this);\r\n  }\r\n  loaded(){\r\n    this.saveImportModule.load();\r\n  }\r\n}\r\nexport default Modules;","import React, {Component} from \"react\";\r\nimport BaseElement from \"../classes/elements/BaseElement\";\r\nimport store from '../store/store'\r\nimport {startDrag} from \"../store/element-drag/actions\";\r\n\r\nexport default class WidgetIcon  extends  Component{\r\n  constructor(props){\r\n    super(props);\r\n\r\n    this.state = {\r\n      element: this.props.element,\r\n    };\r\n    this.onDragStart = this.onDragStart.bind(this);\r\n  }\r\n  onDragStart(e){\r\n    store.dispatch(startDrag(null));\r\n    e.dataTransfer.effectAllowed = \"copy\";\r\n    e.dataTransfer.setData('text/plain', this.state.element.getName());\r\n  }\r\n  render() {\r\n    if (!this.state.element instanceof BaseElement) {\r\n      throw 'Widget Component must has Element in props';\r\n    }\r\n    return <div className='widget-icon' draggable=\"true\" onDragStart={this.onDragStart}>\r\n      {\r\n        React.createElement(this.state.element.getIconComponent(), {height: 35})\r\n      }\r\n      <div className=\"widget-icon__title\">\r\n        {this.state.element.getTitle()}\r\n      </div>\r\n    </div>\r\n  }\r\n}\r\n\r\n","import React, {Component} from \"react\";\r\nimport WidgetIcon from \"./WidgetIcon\";\r\n\r\n\r\nclass WidgetsPanel extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {widgets: window.elementsManager.getWidgetsList()};\r\n  }\r\n  render() {\r\n    return <div className=\"widget-panel\">\r\n      {\r\n        this.state.widgets.map(widget => {\r\n          return <WidgetIcon element={widget} key={widget.getName()}/>;\r\n        })\r\n      }\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default WidgetsPanel","import React, {Component} from \"react\";\r\nimport ChevronIcon from '../../svgs/chevron.svg'\r\nimport Controller from \"../classes/Controller\";\r\n\r\nclass SettingSection extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      open: props.open,\r\n    };\r\n    this.toggle = this.toggle.bind(this);\r\n  }\r\n  toggle(){\r\n    this.setState({\r\n      open: !this.state.open\r\n    });\r\n  }\r\n  render() {\r\n    let controllers = this.props.controls || [];\r\n    let sectionClasses = 'settings-section ' + (this.state.open ? 'open' : '');\r\n    return <div className={sectionClasses}>\r\n      <div className=\"settings-section__title d-flex \" onClick={this.toggle}>\r\n        <div className=\"settings-section__icon d-flex \">\r\n          <ChevronIcon/>\r\n        </div>\r\n        <div className=\"settings-section__label\">\r\n          {this.props.label}\r\n        </div>\r\n      </div>\r\n      <div className=\"controllers-wrapper\">\r\n        {\r\n          controllers.map((controller) => {\r\n                let ControllerComponent = window.controllersManager.getController(controller.type);\r\n                return React.createElement(ControllerComponent, {...controller, key: controller.controlId, controller: new Controller(controller)});\r\n              }\r\n          )\r\n        }\r\n      </div>\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default SettingSection;","import React, {Component} from \"react\";\r\nimport SettingSection from \"./SettingSection\";\r\nimport { Scrollbars } from \"react-custom-scrollbars\";\r\n\r\nclass PanelTabContent extends Component {\r\n    render(){\r\n      let sections =  this.props.sections || [];\r\n      return <div className=\"settings-controllers\">\r\n        <Scrollbars\r\n        autoHide\r\n        autoHideTimeout={500}\r\n        autoHideDuration={200}\r\n        > \r\n          {\r\n            sections.map((section, idx) =>{\r\n              return React.createElement(SettingSection, {\r\n                ...section,\r\n                key: section.sectionId,\r\n                open: idx === 0,\r\n              });\r\n                }\r\n            )\r\n          }\r\n        </Scrollbars>\r\n      </div>\r\n    }\r\n}\r\n\r\nexport default PanelTabContent","import React, {Component} from \"react\";\r\nimport {connect} from 'react-redux';\r\nimport ContentIcon from '../../svgs/content.svg'\r\nimport StyleIcon from '../../svgs/style.svg'\r\nimport AdvancedIcon from '../../svgs/advanced.svg'\r\nimport {TAB_ADVANCED, TAB_CONTENT, TAB_STYLE} from \"../classes/modules/ControllersManager\";\r\nimport PanelTabContent from \"./PanelTabContent\";\r\n\r\nclass SettingsPanel extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      activeTab: 'content',\r\n    };\r\n  }\r\n\r\n  setActiveTab(activeTab){\r\n    this.setState({\r\n        ...this.state, activeTab\r\n    })\r\n  }\r\n\r\n  render() {\r\n\r\n    let controllersManager = window.controllersManager;\r\n\r\n    let sections = [];\r\n    if(this.props.currentElement.getName){\r\n      sections = controllersManager.getControls(this.props.currentElement.getName())[this.state.activeTab] || [];\r\n    }\r\n\r\n    // let sections = this.props.currentElement.getControllers ?\r\n    let contentTabClasses = 'panel-tab d-flex ' + (this.state.activeTab === TAB_CONTENT ? 'active' : '');\r\n    let styleTabClasses = 'panel-tab d-flex ' + (this.state.activeTab === TAB_STYLE ? 'active' : '');\r\n    let advancedTabClasses = 'panel-tab d-flex ' + (this.state.activeTab === TAB_ADVANCED ? 'active' : '');\r\n    return <div className=\"panel settings-panel d-flex\">\r\n      <div className=\"panel-tabs d-flex\">\r\n        <button className={contentTabClasses} onClick={()=>this.setActiveTab(TAB_CONTENT)}>\r\n          <span className=\"panel-tab__icon\">\r\n            <ContentIcon/>\r\n          </span>\r\n          <span className=\"panel-tab__text\">\r\n            Content\r\n          </span>\r\n        </button>\r\n        <button className={styleTabClasses} onClick={()=>this.setActiveTab(TAB_STYLE)}>\r\n          <span className=\"panel-tab__icon\">\r\n            <StyleIcon/>\r\n          </span>\r\n          <span className=\"panel-tab__text\">\r\n            Style\r\n          </span>\r\n        </button>\r\n        <button className={advancedTabClasses} onClick={()=>this.setActiveTab(TAB_ADVANCED)}>\r\n          <span className=\"panel-tab__icon\">\r\n            <AdvancedIcon/>\r\n          </span>\r\n          <span className=\"panel-tab__text\">\r\n            Advanced\r\n          </span>\r\n        </button>\r\n      </div>\r\n      <PanelTabContent sections={sections}/>\r\n    </div>\r\n  }\r\n}\r\nfunction mapStateToProps(state) {\r\n  return{\r\n    currentElement:state.currentElement.currentElement\r\n  };\r\n}\r\nexport default connect(mapStateToProps)(SettingsPanel);","import React, {Component} from \"react\";\r\n\r\n\r\nclass EditorWindow extends Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  render() {\r\n\r\n    return  <div className=\"editor-window\">\r\n\r\n      {/*<Frame>*/}\r\n        {/*<FrameBindingContext>*/}\r\n          {/*<DropTarget/>*/}\r\n        {/*</FrameBindingContext>*/}\r\n      {/*</Frame>*/}\r\n      {/*<Frame src=\"/admin/editor-content\" >*/}\r\n        {/*<FrameBindingContext/>*/}\r\n      {/*</Frame>*/}\r\n      {/*<FrameContextConsumer>*/}\r\n      <iframe src=\"/admin/editor-content\" />\r\n      {/*</FrameContextConsumer>*/}\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default EditorWindow","import React, {Component} from \"react\";\r\n\r\nclass HistoryPanel extends Component {\r\n\r\n  render() {\r\n    return <div className=\"history-panel\">\r\n      HistoryPanel\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default HistoryPanel","import Chevron from '../../svgs/chevron.svg';\r\nimport React, {Component} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {CONSTANTS, getEditor} from \"../helpers\";\r\n\r\nclass UpdateButton extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.saveTemplate = this.saveTemplate.bind(this);\r\n  }\r\n  saveTemplate(e){\r\n    getEditor().modules.saveImportModule.saveTemplate();\r\n  }\r\n render(){\r\n   let buttonClasses = 'btn font_montserrat font_500 btn_grey';\r\n   switch (this.props.templateStatus) {\r\n     case CONSTANTS.TEMPLATE_UPDATED:{\r\n       buttonClasses += ' btn_disabled ';\r\n     }\r\n     break;\r\n     case CONSTANTS.TEMPLATE_NEED_UPDATE:{\r\n       buttonClasses += ' btn_active ';\r\n     }\r\n     break;\r\n   }\r\n   return  <div className=\"control-group d-flex\">\r\n     <button className={buttonClasses} onClick={this.saveTemplate}>\r\n       UPDATE\r\n     </button>\r\n     <button className=\"btn btn_grey\">\r\n       <Chevron className=\"icon\"/>\r\n     </button>\r\n   </div>\r\n }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return{\r\n    templateStatus: state.templateStatus.status,\r\n  };\r\n}\r\nexport default connect(mapStateToProps)(UpdateButton)","// import React, {Component} from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Times from \"../../../svgs/times.svg\";\r\nimport { assetsToggle } from \"../../store/assets-browser/actions\";\r\nimport { iconsManager } from \"../../helpers\";\r\nimport Resource from \"../Resource\";\r\nclass AssetsBrowser extends Component {\r\n  constructor() {\r\n    super();\r\n    this.tabClick = this.tabClick.bind(this);\r\n    this.toggleBrowser = this.toggleBrowser.bind(this);\r\n    this.selectAsset = this.selectAsset.bind(this);\r\n    this.chooseAsset = this.chooseAsset.bind(this);\r\n    this.state = {\r\n      // activeTab: 'icons',\r\n      activeTab: \"media\",\r\n      tabs: [\r\n        // {\r\n        //   name: 'upload',\r\n        //   title: 'Upload Media File',\r\n        // },\r\n        {\r\n          name: \"icons\",\r\n          title: \"Icons Library\"\r\n        },\r\n        {\r\n          name: \"media\",\r\n          title: \"Media Library\"\r\n        }\r\n      ],\r\n      assets: this.getAssets(\"media\"),\r\n      // assets: this.getAssets('icons'),\r\n      selectedAsset: null,\r\n      mediaAssets: []\r\n    };\r\n    this.mediaResource = new Resource({ route: \"/admin/ajax/media\" });\r\n  }\r\n  async componentDidMount() {\r\n    try {\r\n      let res = await this.mediaResource.getAll();\r\n\r\n      this.setState(state => {\r\n        state = { ...state, mediaAssets: res };\r\n        if (state.activeTab === \"media\") {\r\n          state.assets = res;\r\n        }\r\n        return state;\r\n      });\r\n    } catch (error) {\r\n      console.log(\"error\", error);\r\n    }\r\n  }\r\n  getAssets(tab) {\r\n    if (!tab) {\r\n      tab = this.state.activeTab;\r\n    }\r\n\r\n    switch (tab) {\r\n      case \"icons\": {\r\n        return iconsManager().getIconsList();\r\n      }\r\n      case \"media\": {\r\n        return this.state ? this.state.mediaAssets : [];\r\n      }\r\n    }\r\n    return [];\r\n  }\r\n\r\n  selectAsset(e) {\r\n    let selectedAsset = e.currentTarget.dataset.assetname;\r\n    this.setState(state => {\r\n      return { ...state, selectedAsset };\r\n    });\r\n  }\r\n\r\n  tabClick(e) {\r\n    this.setActiveTab(e.target.dataset.tab);\r\n  }\r\n\r\n  setActiveTab(tab) {\r\n    this.setState(state => {\r\n      return { ...state, activeTab: tab, assets: this.getAssets(tab) };\r\n    });\r\n  }\r\n\r\n  toggleBrowser() {\r\n    this.setState(state => {\r\n      return { ...state, selectedAsset: null };\r\n    });\r\n    this.props.dispatch(assetsToggle());\r\n  }\r\n\r\n  chooseAsset() {\r\n    let asset;\r\n    this.state.assets.forEach(item => {\r\n      if (item.name === this.state.selectedAsset) {\r\n        asset = item;\r\n      }\r\n    });\r\n    if (!asset) {\r\n      throw `Asset with name ${this.state.selectedAsset} not found in Assets Browser (${this.state.activeTab})!`;\r\n    }\r\n    this.props.onChoose(asset);\r\n    this.setState(state => {\r\n      return { ...state, selectedAsset: null };\r\n    });\r\n    this.props.dispatch(assetsToggle());\r\n  }\r\n\r\n  render() {\r\n    let classes = \"assets-browser\";\r\n    if (this.props.active) {\r\n      classes += \" assets-browser_active\";\r\n    }\r\n    let buttonClasses = \"btn btn_success\";\r\n    if (!this.state.selectedAsset) {\r\n      buttonClasses += \" btn_disabled\";\r\n    }\r\n    return (\r\n      <div className={classes}>\r\n        <div className=\"assets-browser__bg\" onClick={this.toggleBrowser} />\r\n        <div className=\"assets-browser-content\">\r\n          <div className=\"assets-browser-top\">\r\n            <div className=\"caption\">Append Media</div>\r\n            <button className=\"btn btn_bare assets-browser__close\">\r\n              <Times className=\"icon\" onClick={this.toggleBrowser} />\r\n            </button>\r\n            <div className=\"assets-browser-nav\">\r\n              {this.state.tabs.map(tab => {\r\n                let tabClasses = \"assets-browser__tab\";\r\n                if (this.state.activeTab === tab.name) {\r\n                  tabClasses += \" assets-browser__tab_active\";\r\n                }\r\n                return (\r\n                  <button\r\n                    className={tabClasses}\r\n                    onClick={this.tabClick}\r\n                    key={tab.name}\r\n                    data-tab={tab.name}\r\n                  >\r\n                    {tab.title}\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n          {this.state.assets.length ? (\r\n            <div className=\"assets-browser-choose-frame\">\r\n              {this.state.assets.map(asset => {\r\n                let AssetContent;\r\n                let classes = \"asset-choose\";\r\n                let assetProps = {\r\n                  className: \"asset-choose__content\"\r\n                };\r\n                if (this.state.activeTab === \"icons\") {\r\n                  AssetContent = asset.iconComponent;\r\n                  classes += \" asset-choose_icon\";\r\n                  // assetProps.viewBox = '0 0 20 20';\r\n                  // assetProps.viewport = '0 0 10 10';\r\n                  assetProps.width = \"20\";\r\n                  assetProps.height = \"20\";\r\n                }\r\n                if (this.state.activeTab === \"media\") {\r\n                  AssetContent = \"img\";\r\n                  assetProps.src = asset.url;\r\n                  classes += \" asset-choose_media\";\r\n                  asset.name = asset.filename;\r\n                  asset.assetType = \"media\";\r\n                }\r\n                if (this.state.selectedAsset === asset.name) {\r\n                  classes += \" asset-choose_selected\";\r\n                }\r\n                return (\r\n                  <div\r\n                    className={classes}\r\n                    data-assetname={asset.name}\r\n                    key={asset.name}\r\n                    onClick={this.selectAsset}\r\n                  >\r\n                    <AssetContent {...assetProps} />\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          ) : (\r\n            \"\"\r\n          )}\r\n          <div className=\"assets-browser-bottom\">\r\n            <button className={buttonClasses} onClick={this.chooseAsset}>\r\n              Choose\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    ...state.assetsManagerSettings\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps)(AssetsBrowser);\r\n","import React, { Component } from \"react\";\r\nimport { hot } from \"react-hot-loader\";\r\nimport { Provider } from \"react-redux\";\r\n\r\nimport Modules from \"./js/classes/Modules\";\r\nimport WidgetsPanel from \"./js/components/WidgetsPanel\";\r\nimport SettingsPanel from \"./js/components/SettingsPanel\";\r\nimport EditorWindow from \"./js/components/EditorWindow\";\r\nimport HistoryPanel from \"./js/components/HistoryPanel\";\r\nimport UpdateButton from \"./js/components/UpdateButton\";\r\nimport { CONSTANTS } from \"./js/helpers\";\r\nimport { stopDrag } from \"./js/store/element-drag/actions\";\r\nimport AssetsBrowser from \"./js/classes/modules/AssetsBrowser\";\r\n\r\nimport store from \"../src/js/store/store\";\r\n\r\nimport \"./sass/editor-style.scss\";\r\n\r\nimport DesktopIcon from \"./svgs/desktop.svg\";\r\nimport Logo from \"./svgs/logo.svg\";\r\nimport Navigation from \"./svgs/navigation.svg\";\r\nimport History from \"./svgs/history.svg\";\r\nimport Preview from \"./svgs/preview.svg\";\r\nimport Settings from \"./svgs/settings.svg\";\r\nimport Dots from \"./svgs/dots.svg\";\r\nimport Hamburger from \"./svgs/hamburger.svg\";\r\nimport {contextMenu} from \"react-contexify\";\r\n/**\r\n * Главный класс редактора.<br/>\r\n * Реакт-Компонент.<br/>\r\n * Синглтон, который хранится в глобальной переменной altrpEditor.\r\n *\r\n * */\r\nclass Editor extends Component {\r\n  /**\r\n   * @constructor\r\n   * */\r\n  constructor(props) {\r\n    super(props);\r\n    window.altrpEditor = this;\r\n    this.state = {\r\n      activePanel: 'widgets',\r\n      // activePanel: \"settings\",\r\n      templateStatus: CONSTANTS.TEMPLATE_UPDATED,\r\n    };\r\n    this.openPageSettings = this.openPageSettings.bind(this);\r\n    this.showSettingsPanel = this.showSettingsPanel.bind(this);\r\n    this.showWidgetsPanel = this.showWidgetsPanel.bind(this);\r\n    this.onDragEnd = this.onDragEnd.bind(this);\r\n    this.onClick = this.onClick.bind(this);\r\n    store.subscribe(this.templateStatus.bind(this));\r\n  }\r\n  /**\r\n   * Метод подписчик на изменение состояния Редактора из Редакс хранилища\r\n   * */\r\n  templateStatus() {\r\n    let templateStatus = store.getState().templateStatus.status;\r\n    if (templateStatus !== this.state.templateStatus) {\r\n      this.setState({ ...this.state, templateStatus });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Инициализация модулей\r\n   */\r\n\r\n  initModules() {\r\n    this.modules = new Modules(this);\r\n    this.modules.loaded();\r\n  }\r\n\r\n  /**\r\n   * Показывает панель со списком виджетов\r\n   */\r\n  showWidgetsPanel() {\r\n    this.setState({\r\n      ...this.state,\r\n      activePanel: \"widgets\",\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Показывает панель с настройками текущего виджета\r\n   */\r\n  showSettingsPanel() {\r\n    this.setState({\r\n      ...this.state,\r\n      activePanel: \"settings\",\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Сработывает при клике\r\n   */\r\n  onClick() {\r\n    contextMenu.hideAll();\r\n  }\r\n\r\n  /**\r\n   * Обработчик события конец переноса вызывает метод stopDrag переносимого элемента\r\n   * @see ElementWrapper.stopDrag\r\n   */\r\n  onDragEnd() {\r\n    let draggableElement = store.getState().elementDrag.element;\r\n    if (draggableElement && draggableElement.stopDrag) {\r\n      draggableElement.stopDrag();\r\n    }\r\n    store.dispatch(stopDrag());\r\n  }\r\n  /**\r\n   * Вызывается после загрузки шаблона\r\n   * @see {@link SaveImportModule}\r\n   * */\r\n  endLoading() {\r\n    console.log(\"editor loaded\");\r\n  }\r\n\r\n  /**\r\n   * Вызывается после загрузки компонента\r\n   * @see {@link https://ru.reactjs.org/docs/react-component.html#componentdidmount}\r\n   * */\r\n  componentDidMount() {\r\n    this.initModules();\r\n  }\r\n\r\n  /**\r\n   * Выбирает корневой элемент текущим и открывает панель настроек\r\n   */\r\n\r\n  openPageSettings() {\r\n    this.modules.templateDataStorage.setCurrentRootElement();\r\n    this.showSettingsPanel();\r\n  }\r\n\r\n  /**\r\n   * Отрисовка Компонента\r\n   */\r\n  render() {\r\n    let settingsActive = \"\";\r\n    let templateClasses = \"editor \";\r\n    if (this.state.templateStatus === CONSTANTS.TEMPLATE_SAVING) {\r\n      templateClasses += \" editor_saving\";\r\n    }\r\n    if (\r\n      store.getState().currentElement.currentElement.getType &&\r\n      store.getState().currentElement.currentElement.getType() ===\r\n        \"root-element\" &&\r\n      this.state.activePanel === \"settings\"\r\n    ) {\r\n      settingsActive = \" active\";\r\n    }\r\n\r\n    return (\r\n      <Provider store={store}>\r\n        <div className={templateClasses}\r\n             onClick={this.onClick}\r\n             onDragEnd={this.onDragEnd}>\r\n          <div className=\"left-panel\">\r\n            <div className=\"editor-top-panel\">\r\n              <button\r\n                className=\"btn btn_hamburger\"\r\n                // onClick={this.showSettingsPanel}\r\n              >\r\n                <Hamburger className=\"icon\" />\r\n              </button>\r\n              <div className=\"logo\">\r\n                <Logo viewBox=\"0 0 97 35\" />\r\n              </div>\r\n              <button className=\"btn btn_dots\" onClick={this.showWidgetsPanel}>\r\n                <Dots className=\"icon\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"left-panel-main\">\r\n              {this.state.activePanel === \"widgets\" && <WidgetsPanel />}\r\n              {this.state.activePanel === \"settings\" && <SettingsPanel />}\r\n            </div>\r\n            <div className=\"editor-bottom-panel d-flex align-content-center justify-center\">\r\n              <button\r\n                className={\"btn btn_settings\" + settingsActive}\r\n                onClick={this.openPageSettings}\r\n              >\r\n                <Settings className=\"icon\" />\r\n              </button>\r\n              <button className=\"btn \">\r\n                <Navigation className=\"icon\" />\r\n              </button>\r\n              <button className=\"btn \">\r\n                <History className=\"icon\" />\r\n              </button>\r\n              <button className=\"btn \">\r\n                <DesktopIcon className=\"icon\" />\r\n              </button>\r\n              <button className=\"btn \">\r\n                <Preview className=\"icon\" />\r\n              </button>\r\n              <UpdateButton />\r\n            </div>\r\n          </div>\r\n          <div className=\"right-panel\">\r\n            <EditorWindow />\r\n          </div>\r\n        </div>\r\n        <AssetsBrowser />\r\n      </Provider>\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * Если разработка то включается HMR <br/>\r\n * По умолчанию просто компонент\r\n * @member _export\r\n */\r\nlet _export;\r\nif (process.env.NODE_ENV === \"production\") {\r\n  _export = Editor;\r\n} else {\r\n  _export = hot(module)(Editor);\r\n}\r\n\r\nexport default _export;\r\n"],"sourceRoot":""}