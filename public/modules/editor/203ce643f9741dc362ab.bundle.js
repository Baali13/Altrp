(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{535:function(e,t,n){"use strict";var r=n(0),a=n.n(r);t.a=function(e){var t=e.text;return a.a.createElement("div",{className:"spinner-container"},a.a.createElement("div",{className:"spinner-container__text"},t||"Нет данных"))}},536:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(10),a=n.n(r),c=n(17),o=n.n(c),i=n(99),l=n.n(i),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n,r){return[t,0===r?"?":"&",n=encodeURIComponent(n),"=",encodeURIComponent(e[n])].join("")}),"")},s=function(){var e=o()(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u(n),e.prev=1,e.next=4,l()(t+r);case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",{status:500});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()},538:function(e,t,n){"use strict";var r=n(0),a=n.n(r);t.a=function(){return a.a.createElement("div",{className:"spinner-container"},a.a.createElement("div",{className:"spinner-border",style:{width:"3rem",height:"3rem"},role:"status"},a.a.createElement("span",{className:"sr-only"},"Loading...")))}},575:function(e,t,n){"use strict";var r=n(10),a=n.n(r),c=n(17),o=n.n(c),i=n(35),l=n.n(i),u=n(0),s=n.n(u),d=n(176),m=n(538),p=n(535),f=n(536),b=n(85);t.a=function(e){var t,n=e.widget,r=e.width,c=void 0===r?300:r,i=e.height,g=void 0===i?300:i,v=Object(u.useState)(!1),O=l()(v,2),E=O[0],h=O[1],y=Object(u.useState)([]),w=l()(y,2),j=w[0],k=w[1],P=Object(u.useCallback)(o()(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,Object(f.a)(n.source,n.filter);case 3:200===(t=e.sent).status&&(k(t.data.data),h(!1));case 5:case"end":return e.stop()}}),e)}))),[n]);if(Object(u.useEffect)((function(){P()}),[P]),E)return s.a.createElement(m.a,null);if(0===j.length)return s.a.createElement(p.a,null);var S=j.map((function(e,t){return s.a.createElement(d.DiscreteLegendEntry,{key:t,className:"discrete__legend-item",label:"".concat(e.key," (").concat(e.data,")"),color:b.g[t]||"#606060"})}));return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.BarChart,{height:g,width:c,data:j,series:s.a.createElement(d.BarSeries,{colorScheme:"Custom"===n.options.colorScheme?b.g:n.options.colorScheme,bar:s.a.createElement(d.Bar,{gradient:s.a.createElement(d.Gradient,{stops:[s.a.createElement(d.GradientStop,{stopOpacity:1})]})}),animated:n.options.animated})}),(null===(t=n.options)||void 0===t?void 0:t.legend)&&s.a.createElement(d.DiscreteLegend,{className:"discrete__legend",orientation:n.options.legend,entries:S}))}},576:function(e,t,n){"use strict";var r=n(10),a=n.n(r),c=n(17),o=n.n(c),i=n(35),l=n.n(i),u=n(0),s=n.n(u),d=n(176),m=n(538),p=n(535),f=n(536),b=n(85);t.a=function(e){var t,n=e.widget,r=e.width,c=void 0===r?300:r,i=e.height,g=void 0===i?300:i,v=Object(u.useState)(!1),O=l()(v,2),E=O[0],h=O[1],y=Object(u.useState)([]),w=l()(y,2),j=w[0],k=w[1],P=Object(u.useCallback)(o()(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,Object(f.a)(n.source,n.filter);case 3:200===(t=e.sent).status&&(k(t.data.data||[]),h(!1));case 5:case"end":return e.stop()}}),e)}))),[n]);if(Object(u.useEffect)((function(){P()}),[P]),E)return s.a.createElement(m.a,null);if(!j||0===j.length)return s.a.createElement(p.a,null);var S=j.map((function(e,t){return s.a.createElement(d.DiscreteLegendEntry,{key:t,className:"discrete__legend-item",label:"".concat(e.key," (").concat(e.data,")"),color:b.g[t]||"#606060"})}));return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.PieChart,{height:g,width:c,data:j||[],series:s.a.createElement(d.PieArcSeries,{animated:n.options.animated,explode:n.options.explode,colorScheme:"Custom"===n.options.colorScheme?b.g:n.options.colorScheme,label:s.a.createElement(d.PieArcLabel,{fontSize:12,fontFill:"#000000"})})}),(null===(t=n.options)||void 0===t?void 0:t.legend)&&s.a.createElement(d.DiscreteLegend,{className:"discrete__legend",orientation:n.options.legend,entries:S}))}},577:function(e,t,n){"use strict";var r=n(10),a=n.n(r),c=n(17),o=n.n(c),i=n(35),l=n.n(i),u=n(0),s=n.n(u),d=n(176),m=n(557),p=n(559),f=n(558),b=n(538),g=n(535),v=n(536),O=n(85);t.a=function(e){var t=e.widget,n=e.width,r=void 0===n?300:n,c=e.height,i=void 0===c?300:c,E=e.strokeWidth,h=void 0===E?3:E,y=Object(u.useState)(!1),w=l()(y,2),j=w[0],k=w[1],P=Object(u.useState)([]),S=l()(P,2),x=S[0],D=S[1],C=Object(u.useCallback)(o()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.next=3,Object(v.a)(t.source,t.filter);case 3:200===(n=e.sent).status&&(r=n.data.data.map((function(e){var t=new Date(e.key);if(t)return{key:t,data:e.data}})),D(r),k(!1));case 5:case"end":return e.stop()}}),e)}))),[t]);return Object(u.useEffect)((function(){C()}),[C]),j?s.a.createElement(b.a,null):0===x.length?s.a.createElement(g.a,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(d.LineChart,{height:i,width:r,data:x,xAxis:s.a.createElement(d.LinearXAxis,{type:"time",tickSeries:s.a.createElement(d.LinearXAxisTickSeries,{label:s.a.createElement(d.LinearXAxisTickLabel,{format:function(e){var t=x.slice().shift(),n=x.slice().pop(),r=parseInt(Object(p.a)(t.key,n.key,{unit:"month"}));return r>=0&&r<=12?Object(m.a)(e,"d MMM",{locale:f.a}):Object(m.a)(e,"d MMM yy",{locale:f.a})}})})}),series:s.a.createElement(d.LineSeries,{animated:t.options.animated,line:s.a.createElement(d.Line,{strokeWidth:h}),colorScheme:"Custom"===t.options.colorScheme?O.g:t.options.colorScheme})}))}},578:function(e,t,n){"use strict";var r=n(10),a=n.n(r),c=n(17),o=n.n(c),i=n(35),l=n.n(i),u=n(0),s=n.n(u),d=n(538),m=n(535),p=n(536),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"desc";return function(n,r){if(!n.hasOwnProperty(e)||!r.hasOwnProperty(e))return 0;var a="string"==typeof n[e]?n[e].toUpperCase():n[e],c="string"==typeof r[e]?r[e].toUpperCase():r[e],o=0;return a>c?o=1:a<c&&(o=-1),"desc"===t?-1*o:o}};t.a=function(e){var t=e.widget,n=e.width,r=Object(u.useState)([]),c=l()(r,2),i=c[0],b=c[1],g=Object(u.useState)(!1),v=l()(g,2),O=v[0],E=v[1],h=Object(u.useCallback)(o()(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(!0),e.next=3,Object(p.a)(t.source,t.filter);case 3:200===(n=e.sent).status&&(b(n.data.data.sort(f("data"))),E(!1));case 5:case"end":return e.stop()}}),e)}))),[t]),y=Object(u.useMemo)((function(){return i.reduce((function(e,t){return e+t.data}),0)}),[i]);return Object(u.useEffect)((function(){h()}),[h]),O?s.a.createElement(d.a,null):0===i.length?s.a.createElement(m.a,null):t.options.isVertical?s.a.createElement("div",{className:"widget-table",style:{width:n+"px"}},s.a.createElement("table",{className:"vertical-table"},s.a.createElement("tbody",null,i.map((function(e,t){return s.a.createElement("tr",{key:t},s.a.createElement("td",null,e.key),s.a.createElement("td",null,e.data))})),s.a.createElement("tr",null,s.a.createElement("td",null,"ИТОГО"),s.a.createElement("td",null,y))))):s.a.createElement("div",{className:"widget-table",style:{width:n+"px"}},s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,i.map((function(e,t){return s.a.createElement("th",{key:t},e.key)})),s.a.createElement("th",null,"ИТОГО"))),s.a.createElement("tbody",null,s.a.createElement("tr",null,i.map((function(e,t){return s.a.createElement("td",{key:t},e.data)})),s.a.createElement("td",null,y)))))}},579:function(e,t,n){"use strict";var r=n(10),a=n.n(r),c=n(17),o=n.n(c),i=n(35),l=n.n(i),u=n(0),s=n.n(u),d=n(176),m=n(538),p=n(535),f=n(536),b=n(85);t.a=function(e){var t,n=e.widget,r=e.width,c=void 0===r?300:r,i=e.height,g=void 0===i?300:i,v=Object(u.useState)([]),O=l()(v,2),E=O[0],h=O[1],y=Object(u.useState)(!1),w=l()(y,2),j=w[0],k=w[1],P=Object(u.useCallback)(o()(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.next=3,Object(f.a)(n.source,n.filter);case 3:200===(t=e.sent).status&&(h(t.data.data),k(!1));case 5:case"end":return e.stop()}}),e)}))),[n]);if(Object(u.useEffect)((function(){P()}),[P]),j)return s.a.createElement(m.a,null);if(0===E.length)return s.a.createElement(p.a,null);var S=E.map((function(e,t){return s.a.createElement(d.DiscreteLegendEntry,{key:t,className:"discrete__legend-item",label:"".concat(e.key," (").concat(e.data,")"),color:b.g[t]||"#606060"})}));return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.PieChart,{height:g,width:c,data:E,series:s.a.createElement(d.PieArcSeries,{animated:n.options.animated,doughnut:!0,colorScheme:"Custom"===n.options.colorScheme?b.g:n.options.colorScheme,label:s.a.createElement(d.PieArcLabel,{fontSize:12,fontFill:"#000000"})})}),(null===(t=n.options)||void 0===t?void 0:t.legend)&&s.a.createElement(d.DiscreteLegend,{className:"discrete__legend",orientation:n.options.legend,entries:S}))}},583:function(e,t,n){"use strict";var r=n(10),a=n.n(r),c=n(17),o=n.n(c),i=n(35),l=n.n(i),u=n(0),s=n.n(u),d=n(176),m=n(557),p=n(559),f=n(558),b=function(){return s.a.createElement("div",{className:"spinner-container"},s.a.createElement("div",{className:"spinner-border",style:{width:"3rem",height:"3rem"},role:"status"},s.a.createElement("span",{className:"sr-only"},"Loading...")))},g=n(535),v=n(536);t.a=function(e){var t=e.widget,n=e.width,r=void 0===n?300:n,c=e.height,i=void 0===c?300:c,O=e.color,E=void 0===O?"#FFD51F":O,h=Object(u.useState)([]),y=l()(h,2),w=y[0],j=y[1],k=Object(u.useState)(!1),P=l()(k,2),S=P[0],x=P[1],D=Object(u.useCallback)(o()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,Object(v.a)(t.source,t.filter);case 3:200===(n=e.sent).status&&"string"!=typeof n.data&&(r=n.data.data.map((function(e){var t=new Date(e.key);if(t)return{key:t,data:e.data}})),j(r),x(!1));case 5:case"end":return e.stop()}}),e)}))),[t]);return Object(u.useEffect)((function(){D()}),[D]),S?s.a.createElement(b,null):Array.isArray(w)&&0!==w.length?s.a.createElement(s.a.Fragment,null,s.a.createElement(d.AreaChart,{height:i,width:r,data:w,xAxis:s.a.createElement(d.LinearXAxis,{type:"time",tickSeries:s.a.createElement(d.LinearXAxisTickSeries,{label:s.a.createElement(d.LinearXAxisTickLabel,{format:function(e){var t=w.slice().shift(),n=w.slice().pop(),r=parseInt(Object(p.a)(t.key,n.key,{unit:"month"}));return r>=0&&r<=12?Object(m.a)(e,"d LLL",{locale:f.a}):Object(m.a)(e,"d MMM yy",{locale:f.a})}})})}),series:s.a.createElement(d.AreaSeries,{animated:t.options.animated,type:t.options.type||"standard",markLine:s.a.createElement(d.MarkLine,{strokeWidth:0}),line:s.a.createElement(d.Line,{strokeWidth:0}),area:s.a.createElement(d.Area,{gradient:s.a.createElement(d.Gradient,{color:E,stops:[s.a.createElement(d.GradientStop,{color:E})]})})})})):s.a.createElement(g.a,null)}},687:function(e,t,n){"use strict";n.r(t);var r=n(49),a=n.n(r),c=n(10),o=n.n(c),i=n(8),l=n.n(i),u=n(17),s=n.n(u),d=n(35),m=n.n(d),p=n(0),f=n.n(p),b=n(99),g=n.n(b),v=n(544),O=n(582),E=n(607),h=n(85),y=n(575),w=n(576),j=n(583),k=n(577),P=n(578),S=n(579),x=function(e){var t=e.widget,n=e.width,r=void 0===n?360:n,a=e.height,c=void 0===a?300:a;switch(t.type){case h.b:return f.a.createElement(y.a,{width:r,height:c,widget:t});case h.e:return f.a.createElement(w.a,{width:r,height:c,widget:t});case h.c:return f.a.createElement(S.a,{width:r,height:c,widget:t});case h.d:return f.a.createElement(k.a,{width:r,height:c,widget:t});case h.f:return f.a.createElement(P.a,{width:r,height:c,widget:t});case h.a:return f.a.createElement(j.a,{width:r,height:c,widget:t});default:return f.a.createElement(f.a.Fragment,null)}};function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(e){var t=e.widget,n=e.setWidget,r=e.allowedTypes;return f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Label,null,"Тип виджета"),f.a.createElement(v.a.Control,{as:"select",custom:!0,value:t.type,onChange:function(e){return n(C(C({},t),{},{type:e.target.value}))}},r.map((function(e,t){return f.a.createElement("option",{key:t,value:e},Object(h.h)(e))}))))};var N=function(e){e.widget,e.setWidget;var t=e.param,n=Object(p.useState)([]),r=m()(n,2),a=r[0],c=(r[1],Object(p.useState)(!1)),i=m()(c,2),l=(i[0],i[1]),u=Object(p.useCallback)(function(){var e=s()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!0),e.next=3,g()("/ajax/models/queries/".concat(t.model,"/").concat(t.value));case 3:200===(n=e.sent).status&&(console.log("req.body :>> ",n.body),l(!1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]);return Object(p.useEffect)((function(){0===a.length&&u(t)}),[t]),console.log("param :>> ",t),f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Label,null,t.label),f.a.createElement(v.a.Control,{as:"select",custom:!0,required:!0},f.a.createElement("option",{value:""},"-")))};function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t=e.widget,n=e.setWidget;return f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Label,null,"Легенда"),f.a.createElement(v.a.Control,{as:"select",custom:!0,value:t.options.legend,onChange:function(e){return n(A(A({},t),{},{options:A(A({},t.options),{},{legend:e.target.value})}))},required:!0},f.a.createElement("option",{value:""},"Не показывать"),f.a.createElement("option",{value:"horizontal"},"Горизонтальная"),f.a.createElement("option",{value:"vertical"},"Вертикальная")))};function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(e){var t=e.widget,n=e.setWidget,r=e.sources;return f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Label,null,"Источник данных"),f.a.createElement(v.a.Control,{as:"select",custom:!0,value:t.source,onChange:function(e){return n(F(F({},t),{},{source:e.target.value}))},required:!0},f.a.createElement("option",{value:""},"-"),null==r?void 0:r.map((function(e){var t=e.url,n=e.name;return f.a.createElement("option",{key:t,value:t},n)}))))},T=n(176);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=function(e){var t=e.widget,n=e.setWidget,r=Object.keys(T.schemes).map((function(e){return{label:e,value:e}}));return r=[].concat(a()(r),[{label:"Custom",value:"Custom"}]),f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Label,null,"Цветовая схема"),f.a.createElement(v.a.Control,{as:"select",custom:!0,value:t.options.colorScheme,onChange:function(e){return n(I(I({},t),{},{options:I(I({},t.options),{},{colorScheme:e.target.value})}))},required:!0},r.map((function(e){var t=e.label,n=e.value;return f.a.createElement("option",{key:n,value:n},t)}))))};function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t=e.widget,n=e.setWidget;return f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Check,{type:"checkbox",checked:t.options.isVertical,label:"Вертикальная таблица",onChange:function(e){return n(V(V({},t),{},{options:V(V({},t.options),{},{isVertical:e.target.checked})}))}}))};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=function(e){var t,n,r,c,i,l,u=e.id,d=e.onAdd,b=e.setIsShow,y=e.settings,w=Object(p.useState)({type:h.f,source:"",options:{isVertical:!1,legend:""}}),j=m()(w,2),k=j[0],P=j[1],S=Object(p.useRef)(""),D=function(){var e=s()(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=U(U({},k),{},{title:S.current.value,options:JSON.stringify(k.options),filter:JSON.stringify({})}),e.next=3,g.a.post("/ajax/dashboards/".concat(u),t);case 3:200===(n=e.sent).status&&(d(n.data),b(!1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return console.log("ADDWIDGET settings :>> ",y.filter),f.a.createElement(O.a,null,f.a.createElement(O.a.Header,null,f.a.createElement(O.a.Title,null,"Добавить виджет")),f.a.createElement(O.a.Body,null,f.a.createElement(v.a,null,f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Label,null,"Название виджета"),f.a.createElement(v.a.Control,{type:"text",ref:S,onFocus:function(e){"Новый виджет"===e.target.value&&(S.current.value="")},onBlur:function(e){""===e.target.value&&(S.current.value="Новый виджет")},defaultValue:"Новый виджет",required:!0})),f.a.createElement(G,{widget:k,setWidget:P,sources:y&&(null===(t=y.sql)||void 0===t?void 0:t.map((function(e){return{name:e.label,url:"/ajax/models/queries/".concat(e.model,"/").concat(e.value)}})))}),null===(n=y.filter)||void 0===n?void 0:n.map((function(e){return f.a.createElement(N,{key:e.value,widget:k,setWidget:P,param:e})})),f.a.createElement(L,{widget:k,setWidget:P,allowedTypes:[].concat(a()((r=k.source,l=null===(c=y.sql)||void 0===c?void 0:c.find((function(e){return r==="/ajax/models/queries/".concat(e.model,"/").concat(e.value)})),(null==l||null===(i=l.types)||void 0===i?void 0:i.map((function(e){return e.value})))||[])),[h.f])}),k.source&&k.type===h.f&&f.a.createElement(X,{widget:k,setWidget:P}),f.a.createElement(J,{widget:k,setWidget:P}),f.a.createElement(_,{widget:k,setWidget:P})),f.a.createElement("div",{className:"widget-placeholder"},k.source&&f.a.createElement(x,{widget:k,width:360,height:360}))),f.a.createElement(O.a.Footer,null,f.a.createElement(E.a,{variant:"secondary",onClick:function(){return b(!1)}},"Закрыть"),f.a.createElement(E.a,{variant:"warning",onClick:D,disabled:""===k.source},"Сохранить изменения")))},H=f.a.memo(z),K=n(673),Q=n(674);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=function(e){var t,n,r,c,i,l=e.data,u=e.onEdited,d=e.setIsEdit,b=e.settings,g=Object(p.useState)(l),y=m()(g,2),w=y[0],j=y[1],k=Object(p.useRef)(w.title),P=function(){var e=s()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(Z(Z({},w),{},{title:k.current.value})),d(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return f.a.createElement(O.a,null,f.a.createElement(O.a.Header,null,f.a.createElement(O.a.Title,null,"Редактировать виджет")),f.a.createElement(O.a.Body,null,f.a.createElement(v.a,null,f.a.createElement(v.a.Group,null,f.a.createElement(v.a.Label,null,"Название виджета"),f.a.createElement(v.a.Control,{type:"text",ref:k,defaultValue:w.title,required:!0})),f.a.createElement(G,{widget:w,setWidget:j,sources:b&&(null===(t=b.sql)||void 0===t?void 0:t.map((function(e){return{name:e.label,url:"/ajax/models/queries/".concat(e.model,"/").concat(e.value)}})))}),f.a.createElement(L,{widget:w,setWidget:j,allowedTypes:[].concat(a()((n=w.source,i=b&&(null===(r=b.sql)||void 0===r?void 0:r.find((function(e){return n==="/ajax/models/queries/".concat(e.model,"/").concat(e.value)}))),(null==i||null===(c=i.types)||void 0===c?void 0:c.map((function(e){return e.value})))||[])),[h.f])}),w.source&&w.type===h.f&&f.a.createElement(X,{widget:w,setWidget:j}),f.a.createElement(J,{widget:w,setWidget:j}),f.a.createElement(_,{widget:w,setWidget:j})),f.a.createElement("div",{className:"widget-placeholder"},w.source&&f.a.createElement(x,{widget:w,width:360,height:360}))),f.a.createElement(O.a.Footer,null,f.a.createElement(E.a,{variant:"secondary",onClick:function(){return d(!1)}},"Закрыть"),f.a.createElement(E.a,{variant:"warning",onClick:P,disabled:""===w.source},"Сохранить изменения")))},ee=f.a.memo($);var te=function(e){var t=e.widget,n=e.onDeleted,r=e.onEdited,a=e.sources,c=Object(p.useState)(!1),o=m()(c,2),i=o[0],l=o[1];return f.a.createElement(O.a,{key:t.id},f.a.createElement(O.a.Header,null,f.a.createElement(O.a.Title,null,t.title),f.a.createElement(O.a.Title,null,f.a.createElement("button",{type:"button",title:"Настроить виджет",onClick:function(){return l(!i)}},f.a.createElement(K.a,null)),f.a.createElement("button",{type:"button",title:"Удалить виджет",onClick:function(){return n(t)}},f.a.createElement(Q.a,null)))),f.a.createElement(O.a.Body,null,i?f.a.createElement(ee,{sources:a,data:t,onEdited:r,setIsEdit:l}):f.a.createElement(x,{widget:t,width:360,height:300})))};function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.id,n=e.settings,r=Object(p.useState)([]),c=m()(r,2),i=c[0],l=c[1],u=Object(p.useState)(!1),d=m()(u,2),b=d[0],v=d[1],O=Object(p.useCallback)(function(){var e=s()(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g()("/ajax/dashboards/".concat(t));case 3:200===(r=e.sent).status&&l(r.data.map((function(e){return re(re({},e),{},{options:re(re({},JSON.parse(e.options)),{},{animated:n.animated}),filter:JSON.parse(e.filter)})}))),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),[t,n.animated]),E=function(e){l(i.filter((function(t){return t.id!==e.id}))),g.a.delete("/ajax/dashboards/".concat(e.id))},h=function(e){l(i.map((function(t){return t.id===e.id?e:t}))),g.a.put("/ajax/dashboards/".concat(e.id),re(re({},e),{},{options:JSON.stringify(e.options),filter:JSON.stringify(e.filter)}))};return Object(p.useEffect)((function(){O(t)}),[t]),f.a.createElement("div",{className:"altrp-dashboard"},f.a.createElement("div",{className:"altrp-dashboard__controls"},f.a.createElement("button",{onClick:function(){return v(!0)}},"Добавить виджет")),f.a.createElement("div",{className:"altrp-dashboard__widgets"},b&&f.a.createElement(H,{settings:n,id:t,setIsShow:v,onAdd:function(e){l([e].concat(a()(i)))}}),i.map((function(e){return f.a.createElement(te,{settings:n,key:e.id,widget:e,onDeleted:E,onEdited:h})}))))}}}]);
//# sourceMappingURL=203ce643f9741dc362ab.bundle.js.map