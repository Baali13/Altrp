{"version":3,"sources":["webpack:///./resources/modules/admin/src/components/dashboard/widgets/EmptyWidget.js","webpack:///./resources/modules/admin/src/components/dashboard/services/getWidgetData.js","webpack:///./resources/modules/admin/src/components/dashboard/widgets/Spinner.js","webpack:///./resources/modules/admin/src/components/dashboard/widgets/DynamicBarChart.js","webpack:///./resources/modules/admin/src/components/dashboard/widgets/DynamicPieChart.js","webpack:///./resources/modules/admin/src/components/dashboard/widgets/DynamicLineChart.js","webpack:///./resources/modules/admin/src/components/dashboard/widgets/DynamicTableWidget.js","webpack:///./resources/modules/admin/src/components/dashboard/widgets/DynamicDonutChart.js","webpack:///./resources/modules/admin/src/components/dashboard/Spinner.js","webpack:///./resources/modules/admin/src/components/dashboard/widgets/DynamicAreaChart.js","webpack:///./resources/modules/admin/src/components/dashboard/WidgetDiagram.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/fields/TypeField.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/fields/FilterField.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/fields/LegendField.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/fields/SourceField.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/fields/colorSchemeField.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/fields/VerticalTableField.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/AddWidget.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/EditWidget.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/CardWidget.js","webpack:///./resources/modules/editor/src/js/components/altrp-dashboards/AltrpDashboards.js"],"names":["EmptyWidget","text","className","queryString","obj","Object","keys","reduce","str","key","i","encodeURIComponent","join","getWidgetData","url","filter","a","params","axios","status","Spinner","style","width","height","role","DynamicBarChart","widget","useState","isLoading","setIsLoading","data","setData","getData","useCallback","source","charts","useEffect","length","entries","map","item","label","color","customStyle","series","colorScheme","options","bar","gradient","stops","stopOpacity","animated","legend","orientation","DynamicPieChart","explode","fontSize","fontFill","DynamicLineChart","strokeWidth","newData","Date","xAxis","type","tickSeries","format","d","firstDate","slice","shift","lastDate","pop","diff","parseInt","formatDistanceStrict","unit","locale","ru","line","sortData","order","b","hasOwnProperty","varA","toUpperCase","varB","comparison","DynamicTableWidget","sort","summary","useMemo","acc","isVertical","DynamicDonutChart","doughnut","DynamicAreaChart","Array","isArray","markLine","area","WidgetDiagram","BAR","PIE","DONUT","LINE","TABLE","AREA","TypeField","setWidget","allowedTypes","Form","Group","Label","Control","as","custom","value","onChange","e","target","getTypeName","FilterField","param","getOptions","model","req","console","log","body","required","LegendField","SourceField","sources","name","ColorSchemeField","colors","schemes","VerticalTableField","Check","checked","AddWidget","s","id","onAdd","setIsShow","settings","title","useRef","onSave","current","JSON","stringify","post","Card","Header","Title","Body","ref","onFocus","onBlur","defaultValue","sql","find","types","Footer","Button","variant","onClick","disabled","React","memo","EditWidget","onEdited","setIsEdit","CardWidget","onDeleted","isEdit","AltrpDashboards","widgets","setWidgets","isShow","getWidgets","w","parse","handleRemove","handleEdit","put"],"mappings":"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","file":"24285e468d22008e6686.bundle.js","sourcesContent":["import React from \"react\";\r\n\r\nconst EmptyWidget = ({ text }) => {\r\n  return (\r\n    <div className=\"spinner-container\">\r\n      <div className=\"spinner-container__text\">{text ? text : \"Нет данных\"}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EmptyWidget;\r\n","import axios from \"axios\";\r\n\r\nexport const queryString = (obj = {}) =>\r\n  Object.keys(obj).reduce((str, key, i) => {\r\n    let delimiter, val;\r\n    delimiter = i === 0 ? \"?\" : \"&\";\r\n    key = encodeURIComponent(key);\r\n    val = encodeURIComponent(obj[key]);\r\n    return [str, delimiter, key, \"=\", val].join(\"\");\r\n  }, \"\");\r\n\r\nexport const getWidgetData = async (url, filter) => {\r\n  const params = queryString(filter);\r\n  try {\r\n    return await axios(url + params);\r\n  } catch (error) {\r\n    return { status: 500 };\r\n  }\r\n};\r\n","import React from \"react\";\r\n\r\nconst Spinner = () => {\r\n  return (\r\n    <div className=\"spinner-container\">\r\n      <div className=\"spinner-border\" style={{ width: \"3rem\", height: \"3rem\" }} role=\"status\">\r\n        <span className=\"sr-only\">Loading...</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Spinner;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport {\r\n  BarChart,\r\n  BarSeries,\r\n  Bar,\r\n  Gradient,\r\n  GradientStop,\r\n  DiscreteLegend,\r\n  DiscreteLegendEntry,\r\n} from \"reaviz\";\r\n\r\nimport Spinner from \"./Spinner\";\r\nimport EmptyWidget from \"./EmptyWidget\";\r\n\r\nimport { getWidgetData } from \"../services/getWidgetData\";\r\nimport { customStyle } from \"../widgetTypes\";\r\n\r\nconst DynamicBarChart = ({ widget, width = 300, height = 300 }) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [data, setData] = useState([]);\r\n\r\n  const getData = useCallback(async () => {\r\n    setIsLoading(true);\r\n    const charts = await getWidgetData(widget.source, widget.filter);\r\n    if (charts.status === 200) {\r\n      setData(charts.data.data);\r\n      setIsLoading(false);\r\n    }\r\n  }, [widget]);\r\n\r\n  useEffect(() => {\r\n    getData();\r\n  }, [getData]);\r\n\r\n  if (isLoading) return <Spinner />;\r\n\r\n  if (data.length === 0) return <EmptyWidget />;\r\n\r\n  // Формируем легенду\r\n  const entries = data.map((item, i) => {\r\n    return (\r\n      <DiscreteLegendEntry\r\n        key={i}\r\n        className=\"discrete__legend-item\"\r\n        label={`${item.key} (${item.data})`}\r\n        color={customStyle[i] || \"#606060\"}\r\n      />\r\n    );\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <BarChart\r\n        height={height}\r\n        width={width}\r\n        data={data}\r\n        series={\r\n          <BarSeries\r\n            colorScheme={\r\n              widget.options.colorScheme === \"Custom\" ? customStyle : widget.options.colorScheme\r\n            }\r\n            bar={<Bar gradient={<Gradient stops={[<GradientStop stopOpacity={1} />]} />} />}\r\n            animated={widget.options.animated}\r\n          />\r\n        }\r\n      />\r\n      {widget.options?.legend && (\r\n        <DiscreteLegend\r\n          className=\"discrete__legend\"\r\n          orientation={widget.options.legend}\r\n          entries={entries}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DynamicBarChart;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { PieChart, PieArcSeries, PieArcLabel, DiscreteLegend, DiscreteLegendEntry } from \"reaviz\";\r\n\r\nimport Spinner from \"./Spinner\";\r\nimport EmptyWidget from \"./EmptyWidget\";\r\n\r\nimport { getWidgetData } from \"../services/getWidgetData\";\r\nimport { customStyle } from \"../widgetTypes\";\r\n\r\nconst DynamicPieChart = ({ widget, width = 300, height = 300 }) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [data, setData] = useState([]);\r\n\r\n  const getData = useCallback(async () => {\r\n    setIsLoading(true);\r\n    const charts = await getWidgetData(widget.source, widget.filter);\r\n    if (charts.status === 200) {\r\n      setData(charts.data.data || []);\r\n      setIsLoading(false);\r\n    }\r\n  }, [widget]);\r\n\r\n  useEffect(() => {\r\n    getData();\r\n  }, [getData]);\r\n\r\n  if (isLoading) return <Spinner />;\r\n\r\n  if (!data || data.length === 0) return <EmptyWidget />;\r\n\r\n  // Формируем легенду\r\n  const entries = data.map((item, i) => {\r\n    return (\r\n      <DiscreteLegendEntry\r\n        key={i}\r\n        className=\"discrete__legend-item\"\r\n        label={`${item.key} (${item.data})`}\r\n        color={customStyle[i] || \"#606060\"}\r\n      />\r\n    );\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <PieChart\r\n        height={height}\r\n        width={width}\r\n        data={data || []}\r\n        series={\r\n          <PieArcSeries\r\n            animated={widget.options.animated}\r\n            explode={widget.options.explode}\r\n            colorScheme={\r\n              widget.options.colorScheme === \"Custom\" ? customStyle : widget.options.colorScheme\r\n            }\r\n            label={<PieArcLabel fontSize={12} fontFill=\"#000000\" />}\r\n          />\r\n        }\r\n      />\r\n      {widget.options?.legend && (\r\n        <DiscreteLegend\r\n          className=\"discrete__legend\"\r\n          orientation={widget.options.legend}\r\n          entries={entries}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DynamicPieChart;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport {\r\n  LineChart,\r\n  LineSeries,\r\n  Line,\r\n  LinearXAxis,\r\n  LinearXAxisTickSeries,\r\n  LinearXAxisTickLabel,\r\n} from \"reaviz\";\r\nimport format from \"date-fns/format\";\r\nimport formatDistanceStrict from \"date-fns/formatDistanceStrict\";\r\nimport ru from \"date-fns/locale/ru\";\r\n\r\nimport Spinner from \"./Spinner\";\r\nimport EmptyWidget from \"./EmptyWidget\";\r\n\r\nimport { getWidgetData } from \"../services/getWidgetData\";\r\nimport { customStyle } from \"../widgetTypes\";\r\n\r\nconst DynamicLineChart = ({ widget, width = 300, height = 300, strokeWidth = 3 }) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [data, setData] = useState([]);\r\n\r\n  const getData = useCallback(async () => {\r\n    setIsLoading(true);\r\n    const charts = await getWidgetData(widget.source, widget.filter);\r\n    if (charts.status === 200) {\r\n      const newData = charts.data.data.map((item) => {\r\n        const key = new Date(item.key);\r\n        if (key) {\r\n          return {\r\n            key,\r\n            data: item.data,\r\n          };\r\n        }\r\n      });\r\n      setData(newData);\r\n      setIsLoading(false);\r\n    }\r\n  }, [widget]);\r\n\r\n  const formattingDate = (d) => {\r\n    //  Первая дата\r\n    const firstDate = data.slice().shift();\r\n    // Последняя дата\r\n    const lastDate = data.slice().pop();\r\n    // Разница между датами в месяцах\r\n    const diff = parseInt(\r\n      formatDistanceStrict(firstDate.key, lastDate.key, {\r\n        unit: \"month\",\r\n      })\r\n    );\r\n\r\n    if (diff >= 0 && diff <= 12) {\r\n      return format(d, \"d MMM\", { locale: ru });\r\n    } else {\r\n      return format(d, \"d MMM yy\", { locale: ru });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getData();\r\n  }, [getData]);\r\n\r\n  if (isLoading) return <Spinner />;\r\n\r\n  if (data.length === 0) return <EmptyWidget />;\r\n\r\n  return (\r\n    <>\r\n      <LineChart\r\n        height={height}\r\n        width={width}\r\n        data={data}\r\n        xAxis={\r\n          <LinearXAxis\r\n            type=\"time\"\r\n            tickSeries={\r\n              <LinearXAxisTickSeries\r\n                label={\r\n                  <LinearXAxisTickLabel\r\n                    //fontSize={12}\r\n                    //fill=\"#000000\"\r\n                    format={formattingDate}\r\n                  />\r\n                }\r\n              />\r\n            }\r\n          />\r\n        }\r\n        series={\r\n          <LineSeries\r\n            animated={widget.options.animated}\r\n            line={<Line strokeWidth={strokeWidth} />}\r\n            colorScheme={\r\n              widget.options.colorScheme === \"Custom\" ? customStyle : widget.options.colorScheme\r\n            }\r\n          />\r\n        }\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DynamicLineChart;\r\n","import React, { useState, useEffect, useCallback, useMemo } from \"react\";\r\n\r\nimport Spinner from \"./Spinner\";\r\nimport EmptyWidget from \"./EmptyWidget\";\r\n\r\nimport { getWidgetData } from \"../services/getWidgetData\";\r\n\r\nconst sortData = (key, order = \"desc\") => {\r\n  return function innerSort(a, b) {\r\n    if (!a.hasOwnProperty(key) || !b.hasOwnProperty(key)) {\r\n      return 0;\r\n    }\r\n\r\n    const varA = typeof a[key] === \"string\" ? a[key].toUpperCase() : a[key];\r\n    const varB = typeof b[key] === \"string\" ? b[key].toUpperCase() : b[key];\r\n\r\n    let comparison = 0;\r\n    if (varA > varB) {\r\n      comparison = 1;\r\n    } else if (varA < varB) {\r\n      comparison = -1;\r\n    }\r\n    return order === \"desc\" ? comparison * -1 : comparison;\r\n  };\r\n};\r\n\r\nconst DynamicTableWidget = ({ widget, width }) => {\r\n  const [data, setData] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const getData = useCallback(async () => {\r\n    setIsLoading(true);\r\n    const charts = await getWidgetData(widget.source, widget.filter);\r\n    if (charts.status === 200) {\r\n      setData(charts.data.data.sort(sortData(\"data\")));\r\n      setIsLoading(false);\r\n    }\r\n  }, [widget]);\r\n\r\n  const summary = useMemo(() => data.reduce((acc, item) => acc + item.data, 0), [data]);\r\n\r\n  useEffect(() => {\r\n    getData();\r\n  }, [getData]);\r\n\r\n  if (isLoading) return <Spinner />;\r\n\r\n  if (data.length === 0) return <EmptyWidget />;\r\n\r\n  if (widget.options.isVertical) {\r\n    return (\r\n      <div className=\"widget-table\" style={{ width: width + \"px\" }}>\r\n        <table className=\"vertical-table\">\r\n          <tbody>\r\n            {data.map((item, key) => (\r\n              <tr key={key}>\r\n                <td>{item.key}</td>\r\n                <td>{item.data}</td>\r\n              </tr>\r\n            ))}\r\n            <tr>\r\n              <td>ИТОГО</td>\r\n              <td>{summary}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"widget-table\" style={{ width: width + \"px\" }}>\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            {data.map((item, key) => (\r\n              <th key={key}>{item.key}</th>\r\n            ))}\r\n            <th>ИТОГО</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr>\r\n            {data.map((item, key) => (\r\n              <td key={key}>{item.data}</td>\r\n            ))}\r\n            <td>{summary}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DynamicTableWidget;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { PieChart, PieArcSeries, PieArcLabel, DiscreteLegend, DiscreteLegendEntry } from \"reaviz\";\r\nimport Spinner from \"./Spinner\";\r\nimport EmptyWidget from \"./EmptyWidget\";\r\n\r\nimport { getWidgetData } from \"../services/getWidgetData\";\r\nimport { customStyle } from \"../widgetTypes\";\r\n\r\nconst DynamicDonutChart = ({ widget, width = 300, height = 300 }) => {\r\n  const [data, setData] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const getData = useCallback(async () => {\r\n    setIsLoading(true);\r\n    const charts = await getWidgetData(widget.source, widget.filter);\r\n    if (charts.status === 200) {\r\n      setData(charts.data.data);\r\n      setIsLoading(false);\r\n    }\r\n  }, [widget]);\r\n\r\n  useEffect(() => {\r\n    getData();\r\n  }, [getData]);\r\n\r\n  if (isLoading) return <Spinner />;\r\n\r\n  if (data.length === 0) return <EmptyWidget />;\r\n\r\n  // Формируем легенду\r\n  const entries = data.map((item, i) => {\r\n    return (\r\n      <DiscreteLegendEntry\r\n        key={i}\r\n        className=\"discrete__legend-item\"\r\n        label={`${item.key} (${item.data})`}\r\n        color={customStyle[i] || \"#606060\"}\r\n      />\r\n    );\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <PieChart\r\n        height={height}\r\n        width={width}\r\n        data={data}\r\n        series={\r\n          <PieArcSeries\r\n            animated={widget.options.animated}\r\n            doughnut={true}\r\n            colorScheme={\r\n              widget.options.colorScheme === \"Custom\" ? customStyle : widget.options.colorScheme\r\n            }\r\n            label={<PieArcLabel fontSize={12} fontFill=\"#000000\" />}\r\n          />\r\n        }\r\n      />\r\n      {widget.options?.legend && (\r\n        <DiscreteLegend\r\n          className=\"discrete__legend\"\r\n          orientation={widget.options.legend}\r\n          entries={entries}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DynamicDonutChart;\r\n","import React from \"react\";\r\n\r\nconst Spinner = () => {\r\n  return (\r\n    <div className=\"spinner-container\">\r\n      <div className=\"spinner-border\" style={{ width: \"3rem\", height: \"3rem\" }} role=\"status\">\r\n        <span className=\"sr-only\">Loading...</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Spinner;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport {\r\n  AreaChart,\r\n  AreaSeries,\r\n  MarkLine,\r\n  Line,\r\n  LinearXAxis,\r\n  LinearXAxisTickSeries,\r\n  LinearXAxisTickLabel,\r\n  Area,\r\n  Gradient,\r\n  GradientStop,\r\n} from \"reaviz\";\r\n\r\nimport format from \"date-fns/format\";\r\nimport formatDistanceStrict from \"date-fns/formatDistanceStrict\";\r\nimport ru from \"date-fns/locale/ru\";\r\n\r\nimport Spinner from \"../Spinner\";\r\nimport EmptyWidget from \"./EmptyWidget\";\r\n\r\nimport { getWidgetData } from \"../services/getWidgetData\";\r\n\r\nconst DynamicAreaChart = ({ widget, width = 300, height = 300, color = \"#FFD51F\" }) => {\r\n  const [data, setData] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const getData = useCallback(async () => {\r\n    setIsLoading(true);\r\n    const charts = await getWidgetData(widget.source, widget.filter);\r\n    if (charts.status === 200 && typeof charts.data !== \"string\") {\r\n      const newData = charts.data.data.map((item) => {\r\n        const key = new Date(item.key);\r\n        if (key) {\r\n          return {\r\n            key,\r\n            data: item.data,\r\n          };\r\n        }\r\n      });\r\n      setData(newData);\r\n      setIsLoading(false);\r\n    }\r\n  }, [widget]);\r\n\r\n  const formattingDate = (d) => {\r\n    //  Первая дата\r\n    const firstDate = data.slice().shift();\r\n    // Последняя дата\r\n    const lastDate = data.slice().pop();\r\n    // Разница между датами в месяцах\r\n    const diff = parseInt(\r\n      formatDistanceStrict(firstDate.key, lastDate.key, {\r\n        unit: \"month\",\r\n      })\r\n    );\r\n\r\n    if (diff >= 0 && diff <= 12) {\r\n      return format(d, \"d LLL\", { locale: ru });\r\n    } else {\r\n      return format(d, \"d MMM yy\", { locale: ru });\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getData();\r\n  }, [getData]);\r\n\r\n  if (isLoading) return <Spinner />;\r\n\r\n  if (!Array.isArray(data) || data.length === 0) return <EmptyWidget />;\r\n\r\n  return (\r\n    <>\r\n      <AreaChart\r\n        height={height}\r\n        width={width}\r\n        data={data}\r\n        xAxis={\r\n          <LinearXAxis\r\n            type=\"time\"\r\n            tickSeries={\r\n              <LinearXAxisTickSeries label={<LinearXAxisTickLabel format={formattingDate} />} />\r\n            }\r\n          />\r\n        }\r\n        series={\r\n          <AreaSeries\r\n            animated={widget.options.animated}\r\n            type={widget.options.type || \"standard\"}\r\n            markLine={<MarkLine strokeWidth={0} />}\r\n            line={<Line strokeWidth={0} />}\r\n            area={\r\n              <Area\r\n                gradient={<Gradient color={color} stops={[<GradientStop color={color} />]} />}\r\n              />\r\n            }\r\n          />\r\n        }\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DynamicAreaChart;\r\n","import React from \"react\";\r\n\r\nimport { BAR, PIE, LINE, AREA, TABLE, DONUT } from \"./widgetTypes\";\r\n\r\nimport DynamicBarChart from \"./widgets/DynamicBarChart\";\r\nimport DynamicPieChart from \"./widgets/DynamicPieChart\";\r\nimport DynamicAreaChart from \"./widgets/DynamicAreaChart\";\r\nimport DynamicLineChart from \"./widgets/DynamicLineChart\";\r\nimport DynamicTableWidget from \"./widgets/DynamicTableWidget\";\r\nimport DynamicDonutChart from \"./widgets/DynamicDonutChart\";\r\n\r\nconst WidgetDiagram = ({ widget, width = 360, height = 300 }) => {\r\n  switch (widget.type) {\r\n    case BAR:\r\n      return <DynamicBarChart width={width} height={height} widget={widget} />;\r\n    case PIE:\r\n      return <DynamicPieChart width={width} height={height} widget={widget} />;\r\n    case DONUT:\r\n      return <DynamicDonutChart width={width} height={height} widget={widget} />;\r\n    case LINE:\r\n      return <DynamicLineChart width={width} height={height} widget={widget} />;\r\n    case TABLE:\r\n      return <DynamicTableWidget width={width} height={height} widget={widget} />;\r\n    case AREA:\r\n      return <DynamicAreaChart width={width} height={height} widget={widget} />;\r\n    default:\r\n      return <></>;\r\n  }\r\n};\r\n\r\nexport default WidgetDiagram;\r\n","import React from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nimport { getTypeName } from \"../../../../../../admin/src/components/dashboard/widgetTypes\";\r\n\r\nfunction TypeField({ widget, setWidget, allowedTypes }) {\r\n  return (\r\n    <Form.Group>\r\n      <Form.Label>Тип виджета</Form.Label>\r\n      <Form.Control\r\n        as=\"select\"\r\n        custom\r\n        value={widget.type}\r\n        onChange={(e) => setWidget({ ...widget, type: e.target.value })}\r\n      >\r\n        {allowedTypes.map((value, key) => (\r\n          <option key={key} value={value}>\r\n            {getTypeName(value)}\r\n          </option>\r\n        ))}\r\n      </Form.Control>\r\n    </Form.Group>\r\n  );\r\n}\r\n\r\nexport default TypeField;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport axios from \"axios\";\r\n\r\nfunction FilterField({ widget, setWidget, param }) {\r\n  const [options, setOptions] = useState([]);\r\n  //const [selected, setSelected] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const getOptions = useCallback(\r\n    async (param) => {\r\n      setIsLoading(true);\r\n      const req = await axios(`/ajax/models/queries/${param.model}/${param.value}`);\r\n      if (req.status === 200) {\r\n        console.log(\"req.body :>> \", req.body);\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [param]\r\n  );\r\n\r\n  useEffect(() => {\r\n    options.length === 0 && getOptions(param);\r\n  }, [param]);\r\n\r\n  console.log(\"param :>> \", param);\r\n\r\n  return (\r\n    <Form.Group>\r\n      <Form.Label>{param.label}</Form.Label>\r\n      <Form.Control\r\n        as=\"select\"\r\n        custom\r\n        /* value={widget.filter[param.value] || \"\"}\r\n        onChange={(e) =>\r\n          setWidget({ ...widget, filter: { ...widget.filter, kindId: e.target.value } })\r\n        } */\r\n        required\r\n      >\r\n        <option value=\"\">-</option>\r\n        {/* {options.map(({ id, name }) => (\r\n          <option key={id} value={id}>\r\n            {name}\r\n          </option>\r\n        ))} */}\r\n      </Form.Control>\r\n    </Form.Group>\r\n  );\r\n}\r\n\r\nexport default FilterField;\r\n","import React from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nfunction LegendField({ widget, setWidget }) {\r\n  return (\r\n    <Form.Group>\r\n      <Form.Label>Легенда</Form.Label>\r\n      <Form.Control\r\n        as=\"select\"\r\n        custom\r\n        value={widget.options.legend}\r\n        onChange={(e) =>\r\n          setWidget({\r\n            ...widget,\r\n            options: { ...widget.options, legend: e.target.value },\r\n          })\r\n        }\r\n        required\r\n      >\r\n        <option value=\"\">Не показывать</option>\r\n        <option value=\"horizontal\">Горизонтальная</option>\r\n        <option value=\"vertical\">Вертикальная</option>\r\n      </Form.Control>\r\n    </Form.Group>\r\n  );\r\n}\r\n\r\nexport default LegendField;\r\n","import React from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nfunction SourceField({ widget, setWidget, sources }) {\r\n  return (\r\n    <Form.Group>\r\n      <Form.Label>Источник данных</Form.Label>\r\n      <Form.Control\r\n        as=\"select\"\r\n        custom\r\n        value={widget.source}\r\n        onChange={(e) =>\r\n          setWidget({\r\n            ...widget,\r\n            source: e.target.value,\r\n          })\r\n        }\r\n        required\r\n      >\r\n        <option value=\"\">-</option>\r\n        {sources?.map(({ url, name }) => (\r\n          <option key={url} value={url}>\r\n            {name}\r\n          </option>\r\n        ))}\r\n      </Form.Control>\r\n    </Form.Group>\r\n  );\r\n}\r\n\r\nexport default SourceField;\r\n","import React from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport { schemes } from \"reaviz\";\r\n\r\nfunction ColorSchemeField({ widget, setWidget }) {\r\n  let colors = Object.keys(schemes).map((name) => {\r\n    return { label: name, value: name };\r\n  });\r\n\r\n  colors = [...colors, { label: \"Custom\", value: \"Custom\" }];\r\n\r\n  return (\r\n    <Form.Group>\r\n      <Form.Label>Цветовая схема</Form.Label>\r\n      <Form.Control\r\n        as=\"select\"\r\n        custom\r\n        value={widget.options.colorScheme}\r\n        onChange={(e) =>\r\n          setWidget({ ...widget, options: { ...widget.options, colorScheme: e.target.value } })\r\n        }\r\n        required\r\n      >\r\n        {colors.map(({ label, value }) => (\r\n          <option key={value} value={value}>\r\n            {label}\r\n          </option>\r\n        ))}\r\n      </Form.Control>\r\n    </Form.Group>\r\n  );\r\n}\r\n\r\nexport default ColorSchemeField;\r\n","import React from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nfunction VerticalTableField({ widget, setWidget }) {\r\n  return (\r\n    <Form.Group>\r\n      <Form.Check\r\n        type=\"checkbox\"\r\n        checked={widget.options.isVertical}\r\n        label=\"Вертикальная таблица\"\r\n        onChange={(e) =>\r\n          setWidget({\r\n            ...widget,\r\n            options: { ...widget.options, isVertical: e.target.checked },\r\n          })\r\n        }\r\n      />\r\n    </Form.Group>\r\n  );\r\n}\r\n\r\nexport default VerticalTableField;\r\n","import React, { useState, useRef } from \"react\";\r\nimport axios from \"axios\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Card from \"react-bootstrap/Card\";\r\nimport Button from \"react-bootstrap/Button\";\r\n\r\nimport { BAR, PIE, TABLE, DONUT } from \"../../../../../admin/src/components/dashboard/widgetTypes\";\r\n\r\nimport WidgetDiagram from \"../../../../../admin/src/components/dashboard/WidgetDiagram\";\r\nimport TypeField from \"./fields/TypeField\";\r\nimport FilterField from \"./fields/FilterField\";\r\nimport LegendField from \"./fields/LegendField\";\r\nimport SourceField from \"./fields/SourceField\";\r\nimport ColorSchemeField from \"./fields/colorSchemeField\";\r\nimport VerticalTableField from \"./fields/VerticalTableField\";\r\n\r\nconst AddWidget = ({ id, onAdd, setIsShow, settings }) => {\r\n  const [widget, setWidget] = useState({\r\n    type: TABLE,\r\n    source: \"\",\r\n    options: {\r\n      isVertical: false,\r\n      legend: \"\",\r\n    },\r\n  });\r\n\r\n  const title = useRef(\"\");\r\n\r\n  const onSave = async () => {\r\n    const data = {\r\n      ...widget,\r\n      title: title.current.value,\r\n      options: JSON.stringify(widget.options),\r\n      filter: JSON.stringify({}),\r\n    };\r\n    const req = await axios.post(`/ajax/dashboards/${id}`, data);\r\n    if (req.status === 200) {\r\n      onAdd(req.data);\r\n      setIsShow(false);\r\n    }\r\n  };\r\n\r\n  const handleFocus = (e) => {\r\n    const { value } = e.target;\r\n    if (value === \"Новый виджет\") {\r\n      title.current.value = \"\";\r\n    }\r\n  };\r\n\r\n  const handleBlur = (e) => {\r\n    const { value } = e.target;\r\n    if (value === \"\") {\r\n      title.current.value = \"Новый виджет\";\r\n    }\r\n  };\r\n\r\n  const getTypesBySource = (s) => {\r\n    const source = settings.sql?.find(\r\n      (item) => s === `/ajax/models/queries/${item.model}/${item.value}`\r\n    );\r\n    return source?.types?.map((type) => type.value) || [];\r\n  };\r\n\r\n  console.log(\"ADDWIDGET settings :>> \", settings.filter);\r\n\r\n  return (\r\n    <Card>\r\n      <Card.Header>\r\n        <Card.Title>Добавить виджет</Card.Title>\r\n      </Card.Header>\r\n      <Card.Body>\r\n        <Form>\r\n          <Form.Group>\r\n            <Form.Label>Название виджета</Form.Label>\r\n            <Form.Control\r\n              type=\"text\"\r\n              ref={title}\r\n              onFocus={handleFocus}\r\n              onBlur={handleBlur}\r\n              defaultValue=\"Новый виджет\"\r\n              required\r\n            />\r\n          </Form.Group>\r\n\r\n          <SourceField\r\n            widget={widget}\r\n            setWidget={setWidget}\r\n            sources={settings && settings.sql?.map((item) => {\r\n              return { name: item.label, url: `/ajax/models/queries/${item.model}/${item.value}` };\r\n            })}\r\n          />\r\n\r\n          {settings.filter?.map((param) => (\r\n            <FilterField key={param.value} widget={widget} setWidget={setWidget} param={param} />\r\n          ))}\r\n\r\n          <TypeField\r\n            widget={widget}\r\n            setWidget={setWidget}\r\n            allowedTypes={[...getTypesBySource(widget.source), TABLE]}\r\n          />\r\n\r\n          {widget.source && widget.type === TABLE && (\r\n            <VerticalTableField widget={widget} setWidget={setWidget} />\r\n          )}\r\n\r\n          <ColorSchemeField widget={widget} setWidget={setWidget} />\r\n\r\n          <LegendField widget={widget} setWidget={setWidget} />\r\n        </Form>\r\n\r\n        <div className=\"widget-placeholder\">\r\n          {widget.source && <WidgetDiagram widget={widget} width={360} height={360} />}\r\n        </div>\r\n      </Card.Body>\r\n      <Card.Footer>\r\n        <Button variant=\"secondary\" onClick={() => setIsShow(false)}>\r\n          Закрыть\r\n        </Button>\r\n        <Button variant=\"warning\" onClick={onSave} disabled={widget.source === \"\"}>\r\n          Сохранить изменения\r\n        </Button>\r\n      </Card.Footer>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default React.memo(AddWidget);\r\n","import React, { useState, useRef } from \"react\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Card from \"react-bootstrap/Card\";\r\nimport Button from \"react-bootstrap/Button\";\r\n\r\nimport { TABLE } from \"../../../../../admin/src/components/dashboard/widgetTypes\";\r\n\r\nimport WidgetDiagram from \"../../../../../admin/src/components/dashboard/WidgetDiagram\";\r\nimport TypeField from \"./fields/TypeField\";\r\nimport LegendField from \"./fields/LegendField\";\r\nimport SourceField from \"./fields/SourceField\";\r\nimport ColorSchemeField from \"./fields/colorSchemeField\";\r\nimport VerticalTableField from \"./fields/VerticalTableField\";\r\n\r\nconst EditWidget = ({ data, onEdited, setIsEdit, settings }) => {\r\n  const [widget, setWidget] = useState(data);\r\n\r\n  const title = useRef(widget.title);\r\n\r\n  const onSave = async () => {\r\n    onEdited({\r\n      ...widget,\r\n      title: title.current.value,\r\n    });\r\n    setIsEdit(false);\r\n  };\r\n\r\n  const getTypesBySource = (s) => {\r\n    const source = settings && settings.sql?.find(\r\n      (item) => s === `/ajax/models/queries/${item.model}/${item.value}`\r\n    );\r\n    return source?.types?.map((type) => type.value) || [];\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <Card.Header>\r\n        <Card.Title>Редактировать виджет</Card.Title>\r\n      </Card.Header>\r\n      <Card.Body>\r\n        <Form>\r\n          <Form.Group>\r\n            <Form.Label>Название виджета</Form.Label>\r\n            <Form.Control type=\"text\" ref={title} defaultValue={widget.title} required />\r\n          </Form.Group>\r\n\r\n          <SourceField\r\n            widget={widget}\r\n            setWidget={setWidget}\r\n            sources={settings && settings.sql?.map((item) => {\r\n              return { name: item.label, url: `/ajax/models/queries/${item.model}/${item.value}` };\r\n            })}\r\n          />\r\n\r\n          <TypeField\r\n            widget={widget}\r\n            setWidget={setWidget}\r\n            allowedTypes={[...getTypesBySource(widget.source), TABLE]}\r\n          />\r\n\r\n          {widget.source && widget.type === TABLE && (\r\n            <VerticalTableField widget={widget} setWidget={setWidget} />\r\n          )}\r\n\r\n          <ColorSchemeField widget={widget} setWidget={setWidget} />\r\n\r\n          <LegendField widget={widget} setWidget={setWidget} />\r\n        </Form>\r\n\r\n        <div className=\"widget-placeholder\">\r\n          {widget.source && <WidgetDiagram widget={widget} width={360} height={360} />}\r\n        </div>\r\n      </Card.Body>\r\n      <Card.Footer>\r\n        <Button variant=\"secondary\" onClick={() => setIsEdit(false)}>\r\n          Закрыть\r\n        </Button>\r\n        <Button variant=\"warning\" onClick={onSave} disabled={widget.source === \"\"}>\r\n          Сохранить изменения\r\n        </Button>\r\n      </Card.Footer>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default React.memo(EditWidget);\r\n","import React, { useState } from \"react\";\r\nimport Card from \"react-bootstrap/Card\";\r\nimport GearFill from \"react-bootstrap-icons/dist/icons/gear-fill\";\r\nimport TrashFill from \"react-bootstrap-icons/dist/icons/trash-fill\";\r\n\r\nimport EditWidget from \"./EditWidget\";\r\nimport WidgetDiagram from \"../../../../../admin/src/components/dashboard/WidgetDiagram\";\r\n\r\nfunction CardWidget({ widget, onDeleted, onEdited, sources }) {\r\n  const [isEdit, setIsEdit] = useState(false);\r\n  return (\r\n    <Card key={widget.id}>\r\n      <Card.Header>\r\n        <Card.Title>{widget.title}</Card.Title>\r\n        <Card.Title>\r\n          <button type=\"button\" title=\"Настроить виджет\" onClick={() => setIsEdit(!isEdit)}>\r\n            <GearFill />\r\n          </button>\r\n          <button type=\"button\" title=\"Удалить виджет\" onClick={() => onDeleted(widget)}>\r\n            <TrashFill />\r\n          </button>\r\n        </Card.Title>\r\n      </Card.Header>\r\n      <Card.Body>\r\n        {isEdit ? (\r\n          <EditWidget sources={sources} data={widget} onEdited={onEdited} setIsEdit={setIsEdit} />\r\n        ) : (\r\n          <WidgetDiagram widget={widget} width={360} height={300} />\r\n        )}\r\n      </Card.Body>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default CardWidget;\r\n","import React, { useEffect, useState, useCallback } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nimport AddWidget from \"./AddWidget\";\r\nimport CardWidget from \"./CardWidget\";\r\n\r\nconst AltrpDashboards = ({ id, settings }) => {\r\n  const [widgets, setWidgets] = useState([]);\r\n  const [isShow, setIsShow] = useState(false);\r\n\r\n  const getWidgets = useCallback(\r\n    async (id) => {\r\n      try {\r\n        const req = await axios(`/ajax/dashboards/${id}`);\r\n        if (req.status === 200) {\r\n          setWidgets(\r\n            req.data.map((w) => {\r\n              return {\r\n                ...w,\r\n                options: { ...JSON.parse(w.options), animated: settings.animated },\r\n                filter: JSON.parse(w.filter),\r\n              };\r\n            })\r\n          );\r\n        }\r\n      } catch (error) {}\r\n    },\r\n    [id, settings.animated]\r\n  );\r\n\r\n  const handleAdd = (widget) => {\r\n    setWidgets([widget, ...widgets]);\r\n  };\r\n\r\n  const handleRemove = (widget) => {\r\n    setWidgets(widgets.filter((w) => w.id !== widget.id));\r\n    axios.delete(`/ajax/dashboards/${widget.id}`);\r\n  };\r\n\r\n  const handleEdit = (widget) => {\r\n    setWidgets(widgets.map((w) => (w.id === widget.id ? widget : w)));\r\n    axios.put(`/ajax/dashboards/${widget.id}`, {\r\n      ...widget,\r\n      options: JSON.stringify(widget.options),\r\n      filter: JSON.stringify(widget.filter),\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    getWidgets(id);\r\n  }, [id]);\r\n\r\n  return (\r\n    <div className=\"altrp-dashboard\">\r\n      <div className=\"altrp-dashboard__controls\">\r\n        <button onClick={() => setIsShow(true)}>Добавить виджет</button>\r\n      </div>\r\n      <div className=\"altrp-dashboard__widgets\">\r\n        {isShow && (\r\n          <AddWidget settings={settings} id={id} setIsShow={setIsShow} onAdd={handleAdd} />\r\n        )}\r\n        {widgets.map((widget) => (\r\n          <CardWidget\r\n            settings={settings}\r\n            key={widget.id}\r\n            widget={widget}\r\n            onDeleted={handleRemove}\r\n            onEdited={handleEdit}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AltrpDashboards;\r\n"],"sourceRoot":""}