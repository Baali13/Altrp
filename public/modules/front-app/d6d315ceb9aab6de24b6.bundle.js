(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{104:function(e,t,r){"use strict";r.r(t);var s=r(1),n=r.n(s),i=r(2),a=r.n(i),u=r(9),o=r.n(u),h=r(14),c=r.n(h),f=r(18),l=function(){function e(t,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";n()(this,e),this.formId=t,this.fields=[],this.method=s,this.route=r,this.resource=new f.a({route:r})}var t;return a()(e,[{key:"setFields",value:function(e){this.fields=e}},{key:"addField",value:function(e){return this.fields.push(e),!0}},{key:"submit",value:(t=c()(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,this.fields.forEach((function(e){e.fieldValidate()||(r=!1)})),!r){e.next=19;break}e.t0=this.method,e.next="POST"===e.t0?6:"PUT"===e.t0?9:"DELETE"===e.t0?12:17;break;case 6:return e.next=8,this.resource.post(this.getData());case 8:return e.abrupt("return",e.sent);case 9:return e.next=11,this.resource.put(t,this.getData());case 11:return e.abrupt("return",e.sent);case 12:if(!t){e.next=16;break}return e.next=15,this.resource.delete(t);case 15:return e.abrupt("return",e.sent);case 16:console.error("Не удалось получить ИД модели для удаления!");case 17:e.next=22;break;case 19:return e.next=21,alert("Валидация не прошла");case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getData",value:function(){var e={};return this.fields.forEach((function(t){t.getValue()&&(e[t.getSettings("field_id")]=t.getValue())})),e}}]),e}(),d=new(function(){function e(){n()(this,e),this.forms=[],this.formIds=[],this.fieldsStorage={}}return a()(e,[{key:"registerForm",value:function(e,t,r){var s=this.getForm(e),n="/ajax/models/".concat(t);return s||(s=new l(e,n,r),this.fieldsStorage[e]&&this.fieldsStorage[e].length&&(s.setFields(this.fieldsStorage[e]),delete this.fieldsStorage[e]),this.forms.push(s)),s}},{key:"addField",value:function(e,t){var r=this.getForm(e);return r?r.addField(t):(this.fieldsStorage[e]=this.fieldsStorage[e]||[],this.fieldsStorage[e].push(t),!0)}},{key:"submitForm",value:function(e,t){return this.getForm(e)?this.getForm(e).submit(t):(console.error("Форма не найдена"),!1)}},{key:"getForm",value:function(e){var t=null;return this.forms.forEach((function(r){r.formId===e&&(t=r)})),t}}]),e}());t.default=d}}]);
//# sourceMappingURL=d6d315ceb9aab6de24b6.bundle.js.map