{"version":3,"sources":["webpack:///./resources/modules/front-app/src/js/components/FrontPopup.js","webpack:///./resources/modules/front-app/src/js/components/AreaComponent.js","webpack:///./resources/modules/front-app/src/js/classes/PageLoader.js","webpack:///./resources/modules/front-app/src/js/components/RouteContent.js","webpack:///./resources/modules/editor/src/js/components/Styles.js","webpack:///./resources/modules/front-app/src/js/components/AppContent.js","webpack:///./resources/modules/front-app/src/FrontApp.js","webpack:///./resources/modules/front-app/src/js/store/routes/actions.js","webpack:///./resources/modules/front-app/src/js/store/routes/reducers.js","webpack:///./resources/modules/front-app/src/js/store/reducers.js","webpack:///./resources/modules/front-app/src/js/store/store.js","webpack:///./resources/modules/front-app/src/js/classes/Template.js","webpack:///./resources/modules/front-app/src/js/classes/Area.js"],"names":["FrontPopup","console","log","this","props","template","template_settings","rootElement","window","frontElementsFabric","parseData","data","page","models","className","join","React","createElement","componentClass","element","children","Component","AreaComponent","classes","id","area","getTemplates","length","map","key","pageLoader","resource","Resource","route","pagesStorage","pageId","_","isObject","get","RouteContent","setTitle","title","state","areas","lazy","allowed","loadPage","Area","areaFabric","setState","style","zIndex","autoHide","autoHideTimeout","autoHideDuration","renderTrackVertical","model","to","redirect","Styles","elementStyles","stylesModule","stylesModuleResolve","elementId","styles","elementFound","forEach","elementStyle","push","data-styles-id","AppContent","routes","path","exact","connect","_export","appRoutes","frontApp","getRoutes","then","res","store","appStore","CHANGE_APP_ROUTES","changeAppRoutes","type","defaultState","combineReducers","action","createStore","rootReducer","Template","templates","areaData","settings","JSON","parse","area_name","_t"],"mappings":"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","file":"79a09fbcfb8546a2bfc7.bundle.js","sourcesContent":["import React, {Component} from \"react\";\r\n\r\nclass FrontPopup extends Component {\r\n    render(){\r\n      let classes = [`app-popup`];\r\n\r\n      console.log(this.props.template.template_settings);\r\n      console.log(this.props.template);\r\n      let rootElement  = window.frontElementsFabric.parseData(this.props.template.data, null, this.props.page, this.props.models);\r\n      return <div className={classes.join(' ')}>{\r\n        React.createElement(rootElement.componentClass,\r\n            {\r\n              element: rootElement,\r\n              children: rootElement.children\r\n            })\r\n      }</div>\r\n    }\r\n}\r\n\r\nexport default FrontPopup","import React, {Component} from \"react\";\r\nimport FrontPopup from \"./FrontPopup\";\r\n\r\nclass AreaComponent extends Component {\r\n    render(){\r\n      \r\n      let classes = [`app-area`, `app-area_${this.props.id}`];\r\n      /**\r\n       * Если это попап\r\n       */\r\n      if (this.props.area.getTemplates().length){\r\n        return <div className={classes.join(' ')}>{\r\n          this.props.area.getTemplates().map(template=><FrontPopup key={template.id} template={template}/>)\r\n        }</div>\r\n      }\r\n      /**\r\n       * Если шаблон привязанный к странице удалили, то ничего не отрисовываем\r\n       */\r\n      if(! this.props.template.data){\r\n        return<div className={classes.join(' ')}/>;\r\n      }\r\n      let rootElement =\r\n          window.frontElementsFabric.parseData(this.props.template.data, null, this.props.page, this.props.models);\r\n      return <div className={classes.join(' ')}>{\r\n        React.createElement(rootElement.componentClass,\r\n            {\r\n              element: rootElement,\r\n              children: rootElement.children\r\n            })\r\n      }</div>\r\n    }\r\n}\r\n\r\nexport default AreaComponent","/**\r\n * Загружает и хранит страницы с шаблонами\r\n * @class PageLoader\r\n */\r\nimport Resource from \"../../../../editor/src/js/classes/Resource\";\r\n\r\nclass PageLoader {\r\n  constructor(){\r\n    this.resource = new Resource({\r\n      route: '/ajax/pages'\r\n    });\r\n    this.pagesStorage = {};\r\n  }\r\n\r\n  /**\r\n   * @param {int} pageId\r\n   * @return {Promise}\r\n   */\r\n  async loadPage(pageId){\r\n    if(_.isObject(this.pagesStorage[pageId])){\r\n      // return new Promise((resolve, reject)=>{\r\n      //   resolve(this.pagesStorage[pageId]);\r\n      // });\r\n      return this.pagesStorage[pageId];\r\n    }\r\n    let page = await this.resource.get(pageId);\r\n    this.pagesStorage[pageId] = page;\r\n    return page;\r\n  }\r\n}\r\n\r\nconst pageLoader = new PageLoader;\r\nexport default pageLoader;","import React, {Component} from \"react\";\r\nimport AreaComponent from \"./AreaComponent\";\r\nimport {setTitle} from \"../helpers\";\r\nimport { Scrollbars } from \"react-custom-scrollbars\";\r\nimport {Redirect} from \"react-router-dom\";\r\nimport pageLoader from './../classes/PageLoader'\r\nimport Area from \"../classes/Area\";\r\n\r\nclass RouteContent extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    setTitle(this.props.title);\r\n    this.state = {\r\n      areas: this.props.areas || []\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Меняем заголовок страницы\r\n   * лениво подгружаем области если необходимо и страница доступна к просмотру\r\n   * @return {Promise<void>}\r\n   */\r\n  async componentDidMount(){\r\n    setTitle(this.props.title);\r\n    if(this.props.lazy && this.props.allowed){\r\n      let page = await pageLoader.loadPage(this.props.id);\r\n      let areas = page.areas.map(area=> (Area.areaFabric(area)));\r\n      this.setState(state=>({\r\n          ...state,\r\n        areas,\r\n      }));\r\n    }\r\n  }\r\n  render(){\r\n    if(! this.props.allowed){\r\n      return<Redirect to={this.props.redirect || '/'}/>\r\n    }\r\n    return (\r\n    <Scrollbars\r\n      style={{zIndex: 99999}}\r\n      autoHide\r\n      autoHideTimeout={500}\r\n      autoHideDuration={200}\r\n      renderTrackVertical={({style, ...props})=>{\r\n        return<div className=\"altrp-scroll__vertical-track\" style={style} {...props} />}}\r\n    >\r\n    <div className=\"route-content\">{\r\n      this.state.areas.map(area => <AreaComponent\r\n          {...area}\r\n          area={area}\r\n          page={this.props.id}\r\n          models={[this.props.model]}\r\n          key={'appArea_' + area.id}/>)\r\n    }</div>\r\n    </Scrollbars>\r\n    )\r\n  }\r\n}\r\n\r\nexport default RouteContent;","import React, {Component} from \"react\";\r\n\r\nclass Styles extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      elementStyles: []\r\n    };\r\n    window.stylesModule = this;\r\n    window.stylesModuleResolve(this);\r\n  }\r\n  /**\r\n   * @param {string} elementId\r\n   * @param {string} styles\r\n   * */\r\n  addElementStyles(elementId, styles){\r\n    if(!styles){\r\n      return\r\n    }\r\n    let elementFound = false;\r\n    let elementStyles = [...this.state.elementStyles];\r\n    elementStyles.forEach(elementStyle=>{\r\n      if(elementStyle.elementId === elementId){\r\n        elementFound = true;\r\n        elementStyle.styles = styles;\r\n      }\r\n    });\r\n    if(!elementFound){\r\n      elementStyles.push({\r\n        elementId,\r\n        styles,\r\n      })\r\n    }\r\n    this.setState({\r\n      ...this.state,\r\n      elementStyles\r\n    })\r\n  }\r\n  render(){\r\n    return <div className=\"styles-container\">\r\n      {this.state.elementStyles.map(elementStyle => {\r\n        return<style data-styles-id={elementStyle.elementId} key={elementStyle.elementId}>{elementStyle.styles}</style>\r\n      })}\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default Styles","import React, {Component} from \"react\";\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Link\r\n} from \"react-router-dom\";\r\nimport {connect} from \"react-redux\";\r\nimport RouteContent from \"./RouteContent\";\r\nimport Styles from \"../../../../editor/src/js/components/Styles\";\r\n\r\nclass AppContent extends Component {\r\n  constructor(props){\r\n    super(props);\r\n  }\r\n  componentDidMount(){\r\n\r\n  }\r\n  render(){\r\n    return <Router >\r\n      <div className=\"front-app-content\">\r\n        <Switch>\r\n          {this.props.routes.map(route=><Route key={route.id}\r\n                                               children={ <RouteContent {...route}/>}\r\n                                               path={route.path}\r\n                                               exact />)}\r\n        </Switch>\r\n      </div>\r\n      <Styles/>\r\n    </Router>\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    routes: state.appRoutes.routes\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps)(AppContent);\r\n","import React, {Component} from \"react\";\r\nimport {hot} from \"react-hot-loader\";\r\nimport {getRoutes} from \"./js/helpers\";\r\nimport appStore from \"./js/store/store\";\r\nimport AppContent from \"./js/components/AppContent\";\r\nimport {Provider} from 'react-redux';\r\n\r\nclass FrontApp extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    window.frontApp = this;\r\n    this.getRoutes();\r\n  }\r\n  getRoutes(){\r\n    return getRoutes().then(res => {\r\n      this.routes = res.default;\r\n    });\r\n  }\r\n  render(){\r\n    return <Provider store={appStore}>\r\n      <AppContent/>\r\n    </Provider>;\r\n  }\r\n}\r\n\r\nlet _export;\r\nif (process.env.NODE_ENV === 'production') {\r\n  _export = FrontApp;\r\n} else {\r\n  _export = hot(module)(FrontApp);\r\n}\r\n\r\nexport default _export;\r\n","export const CHANGE_APP_ROUTES = 'CHANGE_APP_ROUTES';\r\n\r\nexport function changeAppRoutes(routes) {\r\n  return {\r\n    type: CHANGE_APP_ROUTES,\r\n    routes\r\n  };\r\n}\r\n\r\n","import {CHANGE_APP_ROUTES} from './actions'\r\n\r\nconst defaultState = {\r\n  routes: [],\r\n};\r\n\r\nexport function appRoutesReducer(state, action) {\r\n  state = state || defaultState;\r\n  switch (action.type) {\r\n    case CHANGE_APP_ROUTES:{\r\n      state = {\r\n        routes: action.routes,\r\n      };\r\n    }break;\r\n  }\r\n  return state;\r\n}","import {combineReducers} from 'redux';\r\nimport {appRoutesReducer} from \"./routes/reducers\";\r\n\r\n\r\nexport default combineReducers({\r\n  appRoutes: appRoutesReducer,\r\n});\r\n","import {createStore} from 'redux';\r\nimport rootReducer from './reducers'\r\n\r\nlet appStore = createStore(rootReducer);\r\n\r\nexport default appStore;","/**\r\n * @property {Int} id\r\n * @property {Object} data\r\n * */\r\nclass Template {\r\n\r\n}\r\n\r\nexport default Template","import Template from './Template';\r\n/**\r\n * @property {Template} template\r\n * @property {Object} settings\r\n * */\r\nclass Area {\r\n  static areaFabric(areaData){\r\n    let area = new Area();\r\n    area.settings = areaData.settings;\r\n    area.id = areaData.id;\r\n    area.template = new Template();\r\n    area.template.data = areaData.template ? JSON.parse(areaData.template.data) : null;\r\n    area.template.id = areaData.template ? areaData.template.id : null;\r\n    if(areaData.area_name === 'popups'){\r\n      // area.templates = [];\r\n      // area.templates = new Template();\r\n      area.templates = [];\r\n      areaData.templates = areaData.templates || [];\r\n      areaData.templates.forEach(_t=>{\r\n        let template = new Template();\r\n        template.data = _t ? JSON.parse(_t.data) : null;\r\n        template.id = _t ? JSON.parse(_t.id) : null;\r\n        template.template_settings = _t ? _t.template_settings : [];\r\n        area.templates.push(template);\r\n      });\r\n    }\r\n    return area;\r\n  }\r\n\r\n  /**\r\n   * Массив шаблонов\r\n   * @return {*|Array}\r\n   */\r\n  getTemplates(){\r\n    this.templates = this.templates || [];\r\n    return this.templates;\r\n  }\r\n}\r\n\r\nexport default Area"],"sourceRoot":""}