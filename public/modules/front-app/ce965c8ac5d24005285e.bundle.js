(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{326:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),l=a.n(c),i=a(12),s=a.n(i),o=a(51),u=a.n(o),d=a(141),m=function(){return r.a.createElement("div",{className:"spinner-container"},r.a.createElement("div",{className:"spinner-border",style:{width:"3rem",height:"3rem"},role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))},E=function(e){var t=e.text;return r.a.createElement("div",{className:"spinner-container"},r.a.createElement("div",{className:"spinner-container__text"},t||"Нет данных"))},f=a(186),p=a.n(f),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,a,n){return[t,0===n?"?":"&",a=encodeURIComponent(a),"=",encodeURIComponent(e[a])].join("")}),"")},v=function(){var e=s()(l.a.mark((function e(t,a){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h(a),e.prev=1,e.next=4,p()(t+n);case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",{status:500});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,a){return e.apply(this,arguments)}}(),g=function(e){var t,a=e.widget,c=e.width,i=void 0===c?300:c,o=e.height,f=void 0===o?300:o,p=Object(n.useState)(!1),h=u()(p,2),g=h[0],b=h[1],w=Object(n.useState)([]),y=u()(w,2),k=y[0],O=y[1],S=Object(n.useCallback)(s()(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.next=3,v(a.source,a.filter);case 3:200===(t=e.sent).status&&(O(t.data.data),b(!1));case 5:case"end":return e.stop()}}),e)}))),[a]);if(Object(n.useEffect)((function(){S()}),[S]),g)return r.a.createElement(m,null);if(0===k.length)return r.a.createElement(E,null);var j=k.map((function(e,t){return r.a.createElement(d.DiscreteLegendEntry,{key:t,className:"discrete__legend-item",label:"".concat(e.key," (").concat(e.data,")")})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.BarChart,{height:f,width:i,data:k,series:r.a.createElement(d.BarSeries,{colorScheme:a.options.colorScheme,bar:r.a.createElement(d.Bar,{gradient:r.a.createElement(d.Gradient,{stops:[r.a.createElement(d.GradientStop,{stopOpacity:1})]})})})}),(null===(t=a.options)||void 0===t?void 0:t.legend)&&r.a.createElement(d.DiscreteLegend,{className:"discrete__legend",orientation:a.options.legend,entries:j}))},b=function(e){var t,a=e.widget,c=e.width,i=void 0===c?300:c,o=e.height,f=void 0===o?300:o,p=Object(n.useState)(!1),h=u()(p,2),g=h[0],b=h[1],w=Object(n.useState)([]),y=u()(w,2),k=y[0],O=y[1],S=Object(n.useCallback)(s()(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.next=3,v(a.source,a.filter);case 3:200===(t=e.sent).status&&(O(t.data.data||[]),b(!1));case 5:case"end":return e.stop()}}),e)}))),[a]);if(Object(n.useEffect)((function(){S()}),[S]),g)return r.a.createElement(m,null);if(!k||0===k.length)return r.a.createElement(E,null);var j=k.map((function(e,t){return r.a.createElement(d.DiscreteLegendEntry,{key:t,className:"discrete__legend-item",label:"".concat(e.key," (").concat(e.data,")")})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.PieChart,{height:f,width:i,data:k||[],series:r.a.createElement(d.PieArcSeries,{explode:a.options.explode,colorScheme:a.options.colorScheme,label:r.a.createElement(d.PieArcLabel,{fontSize:12,fontFill:"#000000"})})}),(null===(t=a.options)||void 0===t?void 0:t.legend)&&r.a.createElement(d.DiscreteLegend,{className:"discrete__legend",orientation:a.options.legend,entries:j}))},w=a(218),y=a(221),k=a(220),O=function(){return r.a.createElement("div",{className:"spinner-container"},r.a.createElement("div",{className:"spinner-border",style:{width:"3rem",height:"3rem"},role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))},S=function(e){var t=e.widget,a=e.width,c=void 0===a?300:a,i=e.height,o=void 0===i?300:i,m=e.color,f=void 0===m?"#FFD51F":m,p=Object(n.useState)([]),h=u()(p,2),g=h[0],b=h[1],S=Object(n.useState)(!1),j=u()(S,2),L=j[0],x=j[1],A=Object(n.useCallback)(s()(l.a.mark((function e(){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,v(t.source,t.filter);case 3:200===(a=e.sent).status&&"string"!=typeof a.data&&(n=a.data.data.map((function(e){var t=new Date(e.key);if(t)return{key:t,data:e.data}})),b(n),x(!1));case 5:case"end":return e.stop()}}),e)}))),[t]);return Object(n.useEffect)((function(){A()}),[A]),L?r.a.createElement(O,null):Array.isArray(g)&&0!==g.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(d.AreaChart,{height:o,width:c,data:g,xAxis:r.a.createElement(d.LinearXAxis,{type:"time",tickSeries:r.a.createElement(d.LinearXAxisTickSeries,{label:r.a.createElement(d.LinearXAxisTickLabel,{format:function(e){var t=g.slice().shift(),a=g.slice().pop(),n=parseInt(Object(y.a)(t.key,a.key,{unit:"month"}));return n>=0&&n<=12?Object(w.a)(e,"d LLL",{locale:k.a}):Object(w.a)(e,"d MMM yy",{locale:k.a})}})})}),series:r.a.createElement(d.AreaSeries,{type:t.options.type||"standard",markLine:r.a.createElement(d.MarkLine,{strokeWidth:0}),line:r.a.createElement(d.Line,{strokeWidth:0}),area:r.a.createElement(d.Area,{gradient:r.a.createElement(d.Gradient,{color:f,stops:[r.a.createElement(d.GradientStop,{color:f})]})})})})):r.a.createElement(E,null)},j=function(e){var t=e.widget,a=e.width,c=void 0===a?300:a,i=e.height,o=void 0===i?300:i,f=e.strokeWidth,p=void 0===f?3:f,h=Object(n.useState)(!1),g=u()(h,2),b=g[0],O=g[1],S=Object(n.useState)([]),j=u()(S,2),L=j[0],x=j[1],A=Object(n.useCallback)(s()(l.a.mark((function e(){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,v(t.source,t.filter);case 3:200===(a=e.sent).status&&(n=a.data.data.map((function(e){var t=new Date(e.key);if(t)return{key:t,data:e.data}})),x(n),O(!1));case 5:case"end":return e.stop()}}),e)}))),[t]);return Object(n.useEffect)((function(){A()}),[A]),b?r.a.createElement(m,null):0===L.length?r.a.createElement(E,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.LineChart,{height:o,width:c,data:L,xAxis:r.a.createElement(d.LinearXAxis,{type:"time",tickSeries:r.a.createElement(d.LinearXAxisTickSeries,{label:r.a.createElement(d.LinearXAxisTickLabel,{format:function(e){var t=L.slice().shift(),a=L.slice().pop(),n=parseInt(Object(y.a)(t.key,a.key,{unit:"month"}));return n>=0&&n<=12?Object(w.a)(e,"d MMM",{locale:k.a}):Object(w.a)(e,"d MMM yy",{locale:k.a})}})})}),series:r.a.createElement(d.LineSeries,{line:r.a.createElement(d.Line,{strokeWidth:p}),colorScheme:t.colorScheme})}))},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"desc";return function(a,n){if(!a.hasOwnProperty(e)||!n.hasOwnProperty(e))return 0;var r="string"==typeof a[e]?a[e].toUpperCase():a[e],c="string"==typeof n[e]?n[e].toUpperCase():n[e],l=0;return r>c?l=1:r<c&&(l=-1),"desc"===t?-1*l:l}},x=function(e){var t=e.widget,a=Object(n.useState)([]),c=u()(a,2),i=c[0],o=c[1],d=Object(n.useState)(!1),f=u()(d,2),p=f[0],h=f[1],g=Object(n.useCallback)(s()(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,v(t.source,t.filter);case 3:200===(a=e.sent).status&&(o(a.data.data.sort(L("data"))),h(!1));case 5:case"end":return e.stop()}}),e)}))),[t]),b=Object(n.useMemo)((function(){return i.reduce((function(e,t){return e+t.data}),0)}),[i]);return Object(n.useEffect)((function(){g()}),[g]),p?r.a.createElement(m,null):0===i.length?r.a.createElement(E,null):t.options.isVertical?r.a.createElement("div",{className:"widget-table"},r.a.createElement("table",{className:"vertical-table"},r.a.createElement("tbody",null,i.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.key),r.a.createElement("td",null,e.data))})),r.a.createElement("tr",null,r.a.createElement("td",null,"ИТОГО"),r.a.createElement("td",null,b))))):r.a.createElement("div",{className:"widget-table"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,i.map((function(e,t){return r.a.createElement("th",{key:t},e.key)})),r.a.createElement("th",null,"ИТОГО"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,i.map((function(e,t){return r.a.createElement("td",{key:t},e.data)})),r.a.createElement("td",null,b)))))},A=function(e){var t,a=e.widget,c=e.width,i=void 0===c?300:c,o=e.height,f=void 0===o?300:o,p=Object(n.useState)([]),h=u()(p,2),g=h[0],b=h[1],w=Object(n.useState)(!1),y=u()(w,2),k=y[0],O=y[1],S=Object(n.useCallback)(s()(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,v(a.source,a.filter);case 3:200===(t=e.sent).status&&(b(t.data.data),O(!1));case 5:case"end":return e.stop()}}),e)}))),[a]);if(Object(n.useEffect)((function(){S()}),[S]),k)return r.a.createElement(m,null);if(0===g.length)return r.a.createElement(E,null);var j=g.map((function(e,t){return r.a.createElement(d.DiscreteLegendEntry,{key:t,className:"discrete__legend-item",label:"".concat(e.key," (").concat(e.data,")")})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.PieChart,{height:f,width:i,data:g,series:r.a.createElement(d.PieArcSeries,{doughnut:!0,colorScheme:a.options.colorScheme,label:r.a.createElement(d.PieArcLabel,{fontSize:12,fontFill:"#000000"})})}),(null===(t=a.options)||void 0===t?void 0:t.legend)&&r.a.createElement(d.DiscreteLegend,{className:"discrete__legend",orientation:a.options.legend,entries:j}))};t.default=function(e){var t,a,n=e.settings,c=null===(t=n.query)||void 0===t||null===(a=t.dataSource)||void 0===a?void 0:a.value;if(console.log("settings.query :>> ",n.query),!c)return r.a.createElement("div",{className:"altrp-chart"},"Choose data for chart");var l={source:c,options:{colorScheme:n.colorScheme,legend:""},filter:{}};switch(n.type){case"CHART/BAR":return r.a.createElement("div",{className:"altrp-chart"},r.a.createElement(g,{widget:l}));case"CHART/PIE":return r.a.createElement("div",{className:"altrp-chart"},r.a.createElement(b,{widget:l}));case"CHART/DONUT":return r.a.createElement("div",{className:"altrp-chart"},r.a.createElement(A,{widget:l}));case"CHART/LINE":return r.a.createElement("div",{className:"altrp-chart"},r.a.createElement(j,{widget:l}));case"CHART/TABLE":return r.a.createElement("div",{className:"altrp-chart"},r.a.createElement(x,{widget:l}));case"CHART/AREA":return r.a.createElement("div",{className:"altrp-chart"},r.a.createElement(S,{widget:l}));default:return r.a.createElement(r.a.Fragment,null)}}}}]);
//# sourceMappingURL=ce965c8ac5d24005285e.bundle.js.map