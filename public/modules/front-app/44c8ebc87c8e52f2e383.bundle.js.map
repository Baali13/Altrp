{"version":3,"sources":["webpack:///./resources/modules/front-app/src/js/classes/Template.js","webpack:///./resources/modules/front-app/src/js/classes/Area.js","webpack:///./node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack:///./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","webpack:///./resources/modules/front-app/src/js/components/FrontPopup.js","webpack:///./resources/modules/front-app/src/js/components/AreaComponent.js","webpack:///./resources/modules/front-app/src/js/classes/PageLoader.js","webpack:///./resources/modules/front-app/src/js/components/RouteContent.js","webpack:///./resources/modules/editor/src/js/components/Styles.js","webpack:///./resources/modules/front-app/src/js/components/AppContent.js","webpack:///./resources/modules/front-app/src/FrontApp.js"],"names":["Template","Area","this","templates","areaData","area","settings","id","template","data","JSON","parse","area_name","forEach","_t","template_settings","push","objectWithoutPropertiesLoose","module","exports","source","excluded","key","i","target","Object","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","prototype","propertyIsEnumerable","call","sourceKeys","keys","FrontPopup","rootElement","window","frontElementsFabric","parseData","props","page","models","className","join","React","createElement","componentClass","element","children","Component","AreaComponent","classes","getTemplates","map","pageLoader","resource","Resource","route","pagesStorage","pageId","_","isObject","get","RouteContent","setTitle","title","state","areas","currentRouterMatch","AltrpModel","match","lazy","allowed","loadPage","areaFabric","setState","changeRouteCurrentModel","appStore","dispatch","clearCurrentDataStorage","updateDataStorage","data_sources","sortBy","data_source","priority","datasource","getWebUrl","params","getParams","res","getType","getQueried","getAll","changeCurrentDataStorage","getAlias","changeCurrentModel","altrpModelUpdated","model","modelName","prevProps","queryCache","clear","isEqual","clearFormStorage","style","zIndex","autoHide","autoHideTimeout","autoHideDuration","renderTrackVertical","to","redirect","withRouter","Styles","elementStyles","stylesModule","stylesModuleResolve","elementId","styles","elementFound","elementStyle","data-styles-id","AppContent","routes","path","exact","connect","_export","appRoutes","frontApp","getRoutes","then","currentUser","changeCurrentUser","store"],"mappings":"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","file":"44c8ebc87c8e52f2e383.bundle.js","sourcesContent":["/**\r\n * @property {Int} id\r\n * @property {Object} data\r\n * */\r\nclass Template {\r\n\r\n}\r\n\r\nexport default Template","import Template from './Template';\r\n/**\r\n * @property {Template} template\r\n * @property {Object} settings\r\n * */\r\nclass Area {\r\n  static areaFabric(areaData){\r\n    let area = new Area();\r\n    area.settings = areaData.settings;\r\n    area.id = areaData.id;\r\n    area.template = new Template();\r\n    area.template.data = areaData.template ? JSON.parse(areaData.template.data) : null;\r\n    area.template.id = areaData.template ? areaData.template.id : null;\r\n    if(areaData.area_name === 'popups'){\r\n      // area.templates = [];\r\n      // area.templates = new Template();\r\n      area.templates = [];\r\n      areaData.templates = areaData.templates || [];\r\n      areaData.templates.forEach(_t=>{\r\n        let template = new Template();\r\n        template.data = _t ? JSON.parse(_t.data) : null;\r\n        template.id = _t ? JSON.parse(_t.id) : null;\r\n        template.template_settings = _t ? _t.template_settings : [];\r\n        area.templates.push(template);\r\n      });\r\n    }\r\n    return area;\r\n  }\r\n\r\n  /**\r\n   * Массив шаблонов\r\n   * @return {*|Array}\r\n   */\r\n  getTemplates(){\r\n    this.templates = this.templates || [];\r\n    return this.templates;\r\n  }\r\n}\r\n\r\nexport default Area","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","import React, {Component} from \"react\";\r\n\r\nclass FrontPopup extends Component {\r\n    render(){\r\n      let classes = [`app-popup`];\r\n\r\n      let rootElement  = window.frontElementsFabric.parseData(this.props.template.data, null, this.props.page, this.props.models);\r\n      return <div className={classes.join(' ')}>{\r\n        React.createElement(rootElement.componentClass,\r\n            {\r\n              element: rootElement,\r\n              children: rootElement.children\r\n            })\r\n      }</div>\r\n    }\r\n}\r\n\r\nexport default FrontPopup","import React, {Component} from \"react\";\r\nimport FrontPopup from \"./FrontPopup\";\r\n\r\nclass AreaComponent extends Component {\r\n    render(){\r\n      \r\n      let classes = [`app-area`, `app-area_${this.props.id}`];\r\n      /**\r\n       * Если это попап\r\n       */\r\n      if (this.props.area.getTemplates().length){\r\n        return <div className={classes.join(' ')}>{\r\n          this.props.area.getTemplates().map(template=><FrontPopup key={template.id} template={template}/>)\r\n        }</div>\r\n      }\r\n      /**\r\n       * Если шаблон привязанный к странице удалили, то ничего не отрисовываем\r\n       */\r\n      if(! this.props.template.data){\r\n        return<div className={classes.join(' ')}/>;\r\n      }\r\n      let rootElement =\r\n          window.frontElementsFabric.parseData(this.props.template.data, null, this.props.page, this.props.models);\r\n      return <div className={classes.join(' ')}>{\r\n        React.createElement(rootElement.componentClass,\r\n            {\r\n              element: rootElement,\r\n              children: rootElement.children\r\n            })\r\n      }</div>\r\n    }\r\n}\r\n\r\nexport default AreaComponent","/**\r\n * Загружает и хранит страницы с шаблонами\r\n * @class PageLoader\r\n */\r\nimport Resource from \"../../../../editor/src/js/classes/Resource\";\r\n\r\nclass PageLoader {\r\n  constructor(){\r\n    this.resource = new Resource({\r\n      route: '/ajax/pages'\r\n    });\r\n    this.pagesStorage = {};\r\n  }\r\n\r\n  /**\r\n   * @param {int} pageId\r\n   * @return {Promise}\r\n   */\r\n  async loadPage(pageId){\r\n    if(_.isObject(this.pagesStorage[pageId])){\r\n      // return new Promise((resolve, reject)=>{\r\n      //   resolve(this.pagesStorage[pageId]);\r\n      // });\r\n      return this.pagesStorage[pageId];\r\n    }\r\n    let page = await this.resource.get(pageId);\r\n    this.pagesStorage[pageId] = page;\r\n    return page;\r\n  }\r\n}\r\n\r\nconst pageLoader = new PageLoader;\r\nexport default pageLoader;","import React, {Component} from \"react\";\r\nimport AreaComponent from \"./AreaComponent\";\r\nimport {setTitle} from \"../helpers\";\r\nimport { Scrollbars } from \"react-custom-scrollbars\";\r\nimport {Redirect, withRouter} from \"react-router-dom\";\r\nimport pageLoader from './../classes/PageLoader'\r\nimport Area from \"../classes/Area\";\r\nimport Resource from \"../../../../editor/src/js/classes/Resource\";\r\nimport appStore from \"../store/store\"\r\nimport {changeCurrentModel} from \"../store/current-model/actions\";\r\nimport {queryCache} from  \"react-query\";\r\nimport {changeCurrentDataStorage, clearCurrentDataStorage} from \"../store/current-data-storage/actions\";\r\nimport AltrpModel from \"../../../../editor/src/js/classes/AltrpModel\";\r\nimport {clearFormStorage} from \"../store/forms-data-storage/actions\";\r\n\r\n\r\nclass RouteContent extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    setTitle(this.props.title);\r\n    this.state = {\r\n      areas: this.props.areas || []\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Меняем заголовок страницы\r\n   * лениво подгружаем области если необходимо и страница доступна к просмотру\r\n   * @return {Promise<void>}\r\n   */\r\n  async componentDidMount(){\r\n    window.currentRouterMatch = new AltrpModel(this.props.match);\r\n    setTitle(this.props.title);\r\n    if(this.props.lazy && this.props.allowed){\r\n      let page = await pageLoader.loadPage(this.props.id);\r\n      let areas = page.areas.map(area=> (Area.areaFabric(area)));\r\n      this.setState(state=>({\r\n          ...state,\r\n        areas,\r\n      }));\r\n    }\r\n    /**\r\n     * Меняем текущую модель\r\n     */\r\n    this.changeRouteCurrentModel();\r\n    /**\r\n     * Обнуляем текущее хранилище dataStorage\r\n     */\r\n    appStore.dispatch(clearCurrentDataStorage());\r\n    /**\r\n     * затем отправляем запросы на обновление\r\n     */\r\n    this.updateDataStorage();\r\n  }\r\n\r\n  /**\r\n   *  обновление currentDataStorage\r\n   */\r\n  async updateDataStorage () {\r\n    /**\r\n     * @member {[]} data_sources\r\n     */\r\n    let { data_sources } = this.props;\r\n    data_sources = _.sortBy(data_sources, data_source => data_source.priority);\r\n    /**\r\n     * @member {Datasource} data_source\r\n     */\r\n    for(let datasource of data_sources){\r\n      if(datasource.getWebUrl()){\r\n        let params = datasource.getParams(this.props.match.params);\r\n        let res = {};\r\n        if(datasource.getType() === 'show') {\r\n          let id = _.get(params, 'id', _.get(this.props, 'match.params.id'));\r\n          if(id){\r\n            res = await (new Resource({route: datasource.getWebUrl()})).get(id);\r\n          }\r\n        } else if(params) {\r\n          res = await (new Resource({route: datasource.getWebUrl()})).getQueried(params);\r\n        } else {\r\n          res = await (new Resource({route: datasource.getWebUrl()})).getAll();\r\n        }\r\n        res = _.get(res, 'data', res);\r\n        appStore.dispatch(changeCurrentDataStorage(datasource.getAlias(), res));\r\n      }\r\n    }\r\n  }\r\n  /**\r\n   * Меняем текущую модель\r\n   */\r\n  async changeRouteCurrentModel(){\r\n    if(_.get(this.props, 'model.modelName') && _.get(this.props, 'match.params.id')){\r\n      appStore.dispatch(changeCurrentModel({altrpModelUpdated: false}));\r\n      let model = await (new Resource({route:`/ajax/models/${this.props.model.modelName}`})).get(this.props.match.params.id);\r\n      model.altrpModelUpdated = true;\r\n      appStore.dispatch(changeCurrentModel(model));\r\n    } else {\r\n      appStore.dispatch(changeCurrentModel({altrpModelUpdated: true}));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Если меняется роут\r\n   * @params {{}} prevProps\r\n   * @return {Promise<void>}\r\n   */\r\n  async componentDidUpdate(prevProps){\r\n    queryCache.clear();\r\n    if((_.get(this.props, 'model.modelName') !== _.get(prevProps, 'model.modelName'))\r\n        || (_.get(this.props, 'match.params.id') !== _.get(prevProps, 'match.params.id'))\r\n    ){\r\n      this.changeRouteCurrentModel();\r\n    }\r\n\r\n    if(! _.isEqual(_.get(this.props, 'match.params'),_.get(prevProps, 'match.params'))){\r\n      this.updateDataStorage();\r\n    }\r\n    if(! _.isEqual(_.get(this.props, 'match'),_.get(prevProps, 'match'))) {\r\n      window.currentRouterMatch = new AltrpModel(this.props.match);\r\n      appStore.dispatch(clearFormStorage())\r\n    }\r\n  }\r\n  render(){\r\n    if(! this.props.allowed){\r\n      return<Redirect to={this.props.redirect || '/'}/>\r\n    }\r\n    return (\r\n    <Scrollbars\r\n      style={{zIndex: 99999}}\r\n      autoHide\r\n      autoHideTimeout={500}\r\n      autoHideDuration={200}\r\n      renderTrackVertical={({style, ...props})=>{\r\n        return<div className=\"altrp-scroll__vertical-track\" style={style} {...props} />}}\r\n    >\r\n    <div className=\"route-content\">{\r\n      this.state.areas.map(area => <AreaComponent\r\n          {...area}\r\n          area={area}\r\n          page={this.props.id}\r\n          models={[this.props.model]}\r\n          key={'appArea_' + area.id}/>)\r\n    }</div>\r\n    </Scrollbars>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(RouteContent);","import React, {Component} from \"react\";\r\n\r\nclass Styles extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      elementStyles: []\r\n    };\r\n    window.stylesModule = this;\r\n    window.stylesModuleResolve(this);\r\n  }\r\n  /**\r\n   * @param {string} elementId\r\n   * @param {string} styles\r\n   * */\r\n  addElementStyles(elementId, styles){\r\n    if(!styles){\r\n      return\r\n    }\r\n    let elementFound = false;\r\n    let elementStyles = [...this.state.elementStyles];\r\n    elementStyles.forEach(elementStyle=>{\r\n      if(elementStyle.elementId === elementId){\r\n        elementFound = true;\r\n        elementStyle.styles = styles;\r\n      }\r\n    });\r\n    if(!elementFound){\r\n      elementStyles.push({\r\n        elementId,\r\n        styles,\r\n      })\r\n    }\r\n    this.setState({\r\n      ...this.state,\r\n      elementStyles\r\n    })\r\n  }\r\n  render(){\r\n    return <div className=\"styles-container\">\r\n      {this.state.elementStyles.map(elementStyle => {\r\n        return<style data-styles-id={elementStyle.elementId} key={elementStyle.elementId}>{elementStyle.styles}</style>\r\n      })}\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default Styles","import React, {Component} from \"react\";\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Link\r\n} from \"react-router-dom\";\r\nimport {connect} from \"react-redux\";\r\nimport RouteContent from \"./RouteContent\";\r\nimport Styles from \"../../../../editor/src/js/components/Styles\";\r\n\r\nclass AppContent extends Component {\r\n  constructor(props){\r\n    super(props);\r\n  }\r\n  componentDidMount(){\r\n\r\n  }\r\n  render(){\r\n    return <Router >\r\n      <div className=\"front-app-content\">\r\n        <Switch>\r\n          {this.props.routes.map(route=><Route key={route.id}\r\n                                               children={ <RouteContent {...route}/>}\r\n                                               path={route.path}\r\n                                               exact />)}\r\n        </Switch>\r\n      </div>\r\n      <Styles/>\r\n    </Router>\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    routes: state.appRoutes.routes\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps)(AppContent);\r\n","import React, {Component} from \"react\";\r\nimport {hot} from \"react-hot-loader\";\r\nimport {getRoutes} from \"./js/helpers\";\r\nimport appStore from \"./js/store/store\";\r\nimport AppContent from \"./js/components/AppContent\";\r\nimport {Provider} from 'react-redux';\r\nimport Resource from \"../../editor/src/js/classes/Resource\";\r\nimport {changeCurrentUser} from \"./js/store/current-user/actions\";\r\n\r\nclass FrontApp extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    window.frontApp = this;\r\n    this.getRoutes();\r\n  }\r\n  getRoutes(){\r\n    return getRoutes().then(res => {\r\n      this.routes = res.default;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Обновляем текущего пользователя\r\n   */\r\n  async componentDidMount() {\r\n    let currentUser = await (new Resource({route: '/ajax/current-user'})).getAll();\r\n    currentUser = currentUser.data;\r\n    appStore.dispatch(changeCurrentUser(currentUser));\r\n  }\r\n  render(){\r\n    return <Provider store={appStore}>\r\n      <AppContent/>\r\n    </Provider>;\r\n  }\r\n}\r\n\r\nlet _export;\r\nif (process.env.NODE_ENV === 'production') {\r\n  _export = FrontApp;\r\n} else {\r\n  _export = hot(module)(FrontApp);\r\n}\r\n\r\nexport default _export;\r\n"],"sourceRoot":""}