exports.ids=[18],exports.modules={212:function(e,t,r){"use strict";r.r(t);var n=r(15),a=r.n(n),o=r(12),c=r.n(o),l=r(9),i=r.n(l),u=r(16),s=r.n(u),p=r(2),d=r.n(p),m=r(0),f=r.n(m),g=r(84),v=r.n(g),b=r(123),O=r.n(b),y=r(124),h=r.n(y),E=r(125),j=r.n(E),w=r(74),P=r.n(w),D=r(126),k=r.n(D),C=r(85),S=r.n(C),x=r(73),N=r.n(x),T=r(86),q=r.n(T),W=r(94),I=r.n(W),M=r(141),G=r(162),J=r(164),L=r(166),F=r(168),R=r(169),B=function(e){var t=e.widget,r=e.width,n=void 0===r?350:r,a=e.height,o=void 0===a?450:a;switch(t.type){case M.a:return f.a.createElement(G.a,{width:n,height:o,widget:t,isDashboard:!0});case M.c:return f.a.createElement(J.a,{width:n,height:o,widget:t,isDashboard:!0});case M.b:return f.a.createElement(L.a,{width:n,height:o,widget:t,isDashboard:!0});case M.e:return f.a.createElement(F.a,{width:n,height:o,widget:t,isDashboard:!0});case M.d:return f.a.createElement(R.a,{width:n,height:o,widget:t,isDashboard:!0});default:return f.a.createElement(f.a.Fragment,null)}};function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V=function(e){var t=e.widget,r=e.setWidget,n=e.allowedTypes;return f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Label,null,"Тип виджета"),f.a.createElement(N.a.Control,{as:"select",custom:!0,value:t.type,onChange:function(e){return r(A(A({},t),{},{type:e.target.value}))}},n.map((function(e,t){return f.a.createElement("option",{key:t,value:e},Object(M.g)(e))}))))};function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z=function(e){var t,r=e.widget,n=e.setWidget,a=e.param,o=e.changeTitle,l=Object(m.useState)([]),u=s()(l,2),p=u[0],g=u[1],v=Object(m.useState)(!1),b=s()(v,2),O=(b[0],b[1]),y=Object(m.useCallback)(function(){var e=i()(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("KOSTYA =>",t),O(!0),e.next=4,P()("/ajax/models/queries/".concat(t.model,"/").concat(t.value));case 4:200===(r=e.sent).status&&(console.log(r.data.data),g(r.data.data),O(!1));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[a]);return Object(m.useEffect)((function(){0===p.length&&y(a)}),[a]),f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Label,null,a.label),f.a.createElement(N.a.Control,{as:"select",custom:!0,value:(null===(t=r.filter)||void 0===t?void 0:t[a.value])||"",onChange:function(e){var t=r.filter[a.value]||{},l=p.find((function(e){return e.value==t})),i=void 0!==l&&l.label;console.log(i,"<---"),n(H(H({},r),{},{filter:H(H({},r.filter),{},c()({},a.value,e.target.value))}));var u=p.find((function(t){return t.value==e.target.value})).label||"";o(" / ".concat(u)," / ".concat(i))},required:!0},f.a.createElement("option",{value:""},"-"),p.map((function(e){var t=e.value,r=e.label;return f.a.createElement("option",{key:t,value:t},r)}))))};function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var U=function(e){var t=e.widget,r=e.setWidget;return f.a.createElement(N.a.Group,{className:"d-none"},f.a.createElement(N.a.Label,null,"Легенда"),f.a.createElement(N.a.Control,{as:"select",custom:!0,value:t.options.legend,onChange:function(e){return r(Q(Q({},t),{},{options:Q(Q({},t.options),{},{legend:e.target.value})}))},required:!0},f.a.createElement("option",{value:""},"Не показывать"),f.a.createElement("option",{value:"horizontal"},"Горизонтальная"),f.a.createElement("option",{value:"vertical"},"Вертикальная")))};function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $=function(e){var t=e.widget,r=e.setWidget;return f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Label,null,"Положение легенды"),f.a.createElement(N.a.Control,{as:"select",custom:!0,value:t.options.legendPosition,onChange:function(e){return r(Z(Z({},t),{},{options:Z(Z({},t.options),{},{legendPosition:e.target.value,legend:"left"==e.target.value||"right"==e.target.value?"vertical":"horizontal"})}))},required:!0},f.a.createElement("option",{value:"bottom"},"Внизу"),f.a.createElement("option",{value:"left"},"Слева"),f.a.createElement("option",{value:"right"},"Справа"),f.a.createElement("option",{value:"top"},"Сверху")))};function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var re=function(e){var t=e.widget,r=e.setWidget,n=e.sources,a=e.changeTitle;return f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Label,{className:{"d-none":1===n.length}},n.length>1||0==n.length?"Источник данных":"Источник данных: ".concat(n[0].name)),f.a.createElement(N.a.Control,{as:"select",custom:!0,className:{"d-none":1===n.length},value:t.source,onChange:function(e){r(te(te({},t),{},{source:e.target.value}));var o=n.find((function(t){return t.url==e.target.value})).label||"";a(" / ".concat(o))},required:!0},f.a.createElement("option",{value:""},"-"),n.map((function(e){var t=e.url,r=e.name;return f.a.createElement("option",{key:t,value:t},r)}))))},ne=r(127);function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ce=function(e){var t=e.widget,r=e.setWidget,n=Object.keys(ne.schemes).map((function(e){return{label:e,value:e}}));return n=[].concat(a()(n),[{label:"Custom",value:"Custom"}]),f.a.createElement(N.a.Group,{className:"d-none"},f.a.createElement(N.a.Label,null,"Цветовая схема"),f.a.createElement(N.a.Control,{as:"select",custom:!0,value:t.options.colorScheme,onChange:function(e){return r(oe(oe({},t),{},{options:oe(oe({},t.options),{},{colorScheme:e.target.value})}))},required:!0},n.map((function(e){var t=e.label,r=e.value;return f.a.createElement("option",{key:r,value:r},t)}))))};function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ue=function(e){var t=e.widget,r=e.setWidget;return f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Check,{type:"checkbox",checked:t.options.isVertical,label:"Вертикальная таблица",onChange:function(e){return r(ie(ie({},t),{},{options:ie(ie({},t.options),{},{isVertical:e.target.checked})}))}}))};function se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?se(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var de=function(e){var t=e.widget,r=e.setWidget;return f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Label,null,"Сортировка данных"),f.a.createElement(N.a.Control,{as:"select",custom:!0,value:t.options.sort||0,onChange:function(e){return r(pe(pe({},t),{},{options:pe(pe({},t.options),{},{sort:e.target.value})}))},required:!0},[{label:"Без сортировки",value:0},{label:"По ключу",value:1},{label:"По значению",value:2}].map((function(e){var t=e.label,r=e.value;return f.a.createElement("option",{key:r,value:r},t)}))))};function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ge=function(e){var t,r,n,o,c=e.id,l=e.onAdd,u=e.setIsShow,p=e.settings,g=Object(m.useState)({type:M.e,source:"",options:{isVertical:!1,legend:"",legendPosition:"bottom",colorScheme:"Custom"},filter:{}}),v=s()(g,2),b=v[0],O=v[1],y=Object(m.useRef)(""),h=function(){var e=i()(d.a.mark((function e(){var t,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=fe(fe({},b),{},{title:y.current.value,options:JSON.stringify(b.options),filter:JSON.stringify(b.filter)}),console.log("ON SAVE =>",JSON.stringify(b.options),JSON.stringify(b.filter)),e.next=4,P.a.post("/ajax/dashboards/".concat(c),t);case 4:200===(r=e.sent).status&&(l(r.data),u(!1));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];y.current.value.includes(t)&&(y.current.value=y.current.value.replace(t,e)),y.current.value.includes(e)||(y.current.value+=e)},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e&&0!==e.length?e.map((function(e){return{name:e.label,url:"/ajax/models/queries/".concat(e.model,"/").concat(e.value)}})):[]};if(1===j(p.sql).length){var w=j(p.sql)[0];b.source=w.url,setTimeout((function(){return E("".concat(w.name))}),0)}return f.a.createElement(q.a,null,f.a.createElement(q.a.Header,null,f.a.createElement(q.a.Title,null,"Добавить виджет")),f.a.createElement(q.a.Body,null,f.a.createElement(N.a,null,f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Label,null,"Название виджета"),f.a.createElement(N.a.Control,{type:"text",ref:y,onFocus:function(e){"Новый виджет"===e.target.value&&(y.current.value="")},onBlur:function(e){""===e.target.value&&(y.current.value="Новый виджет")},defaultValue:"",required:!0})),f.a.createElement(re,{widget:b,setWidget:O,sources:j(p.sql),changeTitle:E}),f.a.createElement(de,{widget:b,setWidget:O}),b.source&&(null===(t=p.filter)||void 0===t?void 0:t.length)>0&&(null===(r=p.filter)||void 0===r?void 0:r.map((function(e){return f.a.createElement(z,{key:e.value,widget:b,setWidget:O,param:e,changeTitle:E})}))),f.a.createElement(V,{widget:b,setWidget:O,allowedTypes:[].concat(a()(function(e){var t,r,n=e;n=n.includes("?")?n.split("?")[0]:e;var a=null===(t=p.sql)||void 0===t?void 0:t.find((function(e){return n==="/ajax/models/queries/".concat(e.model,"/").concat(e.value)}));return(null==a||null===(r=a.types)||void 0===r?void 0:r.map((function(e){return e.value})))||[]}(b.source)),[M.e])}),b.source&&b.type===M.e&&f.a.createElement(ue,{widget:b,setWidget:O}),f.a.createElement(ce,{widget:b,setWidget:O}),(null===(n=b.options)||void 0===n?void 0:n.legend)&&f.a.createElement($,{widget:b,setWidget:O})),f.a.createElement("div",{className:"widget-placeholder altrp-chart ".concat(null===(o=b.options)||void 0===o?void 0:o.legendPosition)},b.source&&f.a.createElement(B,{widget:b,width:360,height:360}))),f.a.createElement(q.a.Footer,null,f.a.createElement(I.a,{variant:"secondary",onClick:function(){return u(!1)}},"Закрыть"),f.a.createElement(I.a,{variant:"warning",onClick:h,disabled:""===b.source},"Сохранить")))},ve=r(128),be=r.n(ve),Oe=r(129),ye=r.n(Oe),he=r(95),Ee=r.n(he),je=r(96),we=r.n(je),Pe=r(97),De=r.n(Pe),ke=r(98),Ce=r.n(ke);function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ne=function(e){var t,r,n,o=e.data,c=e.onEdited,l=e.setIsEdit,u=e.settings,p=Object(m.useState)(o),g=s()(p,2),v=g[0],b=g[1],O=Object(m.useRef)(v.title),y=function(){var e=i()(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(xe(xe({},v),{},{title:O.current.value})),l(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e&&0!==e.length?e.map((function(e){return{name:e.label,url:"/ajax/models/queries/".concat(e.model,"/").concat(e.value)}})):[]},E=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];O.current.value.includes(t)&&(O.current.value=O.current.value.replace(t,e)),O.current.value.includes(e)||(O.current.value+=e)};if(1===h(u.sql).length){var j=h(u.sql)[0];v.source=j.url}return f.a.createElement(q.a,null,f.a.createElement(q.a.Header,null),f.a.createElement(q.a.Body,null,f.a.createElement(N.a,null,f.a.createElement(N.a.Group,null,f.a.createElement(N.a.Label,null,"Название виджета"),f.a.createElement(N.a.Control,{type:"text",ref:O,defaultValue:v.title,required:!0})),f.a.createElement(re,{widget:v,setWidget:b,sources:h(u.sql),changeTitle:E}),f.a.createElement(de,{widget:v,setWidget:b}),v.source&&(null===(t=u.filter)||void 0===t?void 0:t.length)>0&&(null===(r=u.filter)||void 0===r?void 0:r.map((function(e){return f.a.createElement(z,{key:e.value,widget:v,setWidget:b,param:e,changeTitle:E})}))),f.a.createElement(V,{widget:v,setWidget:b,allowedTypes:[].concat(a()(function(e){var t,r,n=e;n=n.includes("?")?n.split("?")[0]:e;var a=u&&(null===(t=u.sql)||void 0===t?void 0:t.find((function(e){return n==="/ajax/models/queries/".concat(e.model,"/").concat(e.value)})));return(null==a||null===(r=a.types)||void 0===r?void 0:r.map((function(e){return e.value})))||[]}(v.source)),[M.e])}),v.source&&v.type===M.e&&f.a.createElement(ue,{widget:v,setWidget:b}),f.a.createElement(ce,{widget:v,setWidget:b}),f.a.createElement(U,{widget:v,setWidget:b}),f.a.createElement($,{widget:v,setWidget:b})),f.a.createElement("div",{className:"widget-placeholder altrp-chart ".concat(null===(n=v.options)||void 0===n?void 0:n.legendPosition)},v.source&&f.a.createElement(B,{widget:v,width:360,height:360}))),f.a.createElement(q.a.Footer,null,f.a.createElement(I.a,{variant:"secondary",onClick:function(){return l(!1)}},"Закрыть"),f.a.createElement(I.a,{variant:"warning",onClick:y,disabled:""===v.source},"Сохранить")))},Te=f.a.memo(Ne);r(99);var qe=function(e){var t,r=e.widget,n=e.onDeleted,a=e.onEdited,o=e.settings,c=(e.isMobile,Object(m.useState)(!1)),l=s()(c,2),u=l[0],p=l[1],g=Object(m.useRef)(null),b=function(){var e=i()(d.a.mark((function e(){var t,r,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.current.querySelector(".card-body"),e.next=3,be.a.toPng(t);case 3:r=e.sent,(n=document.createElement("a")).download="widget_".concat((new Date).getTime(),".png"),n.href=r,n.click();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return f.a.createElement(q.a,{key:r.id,ref:g},f.a.createElement(q.a.Header,null,f.a.createElement(q.a.Title,null,r.title),f.a.createElement(q.a.Title,null,f.a.createElement("div",{className:"dropdownTogglerContainer"},f.a.createElement(v.a,{drop:"left"},f.a.createElement(v.a.Toggle,{variant:"light"},f.a.createElement(S.a,{color:"#7a7a7b"})),f.a.createElement(v.a.Menu,{className:"dropdownMenuToggle",style:{zIndex:999999,background:"rgba(255,255,255,1)"}},f.a.createElement(v.a.Item,null,f.a.createElement(ye.a,{trigger:function(){return f.a.createElement("button",{type:"button",title:"Распечатать виджет"},f.a.createElement(De.a,null))},content:function(){return g.current}})),f.a.createElement(v.a.Item,null,f.a.createElement("button",{type:"button",title:"Скачать файл",onClick:b},f.a.createElement(Ce.a,null))),f.a.createElement(v.a.Item,null,f.a.createElement("button",{type:"button",title:"Настроить виджет",onClick:function(){return p(!u)}},f.a.createElement(Ee.a,null))),f.a.createElement(v.a.Item,null,f.a.createElement("button",{type:"button",title:"Удалить виджет",onClick:function(){return n(r)}},f.a.createElement(we.a,null)))))))),f.a.createElement(q.a.Body,{className:"altrp-chart ".concat(null===(t=r.options)||void 0===t?void 0:t.legendPosition)},u?f.a.createElement(Te,{settings:o,data:r,onEdited:a,setIsEdit:p}):f.a.createElement(B,{widget:r,width:360,height:300})))},We=r(4),Ie=r.n(We),Me=r(5),Ge=r.n(Me),Je=r(7),Le=r.n(Je),Fe=r(8),Re=r.n(Fe),Be=r(1),Ye=r.n(Be);function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Ye()(e);if(t){var a=Ye()(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Re()(this,r)}}var Ve=function(e){Le()(n,e);var t,r=Ae(n);function n(e){var t;return Ie()(this,n),(t=r.call(this,e)).state={options:[]},t}return Ge()(n,[{key:"componentDidMount",value:(t=i()(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P()("/ajax/models/queries/".concat(this.props.parameter.model,"/").concat(this.props.parameter.value));case 2:200===(t=e.sent).status?this.setState({options:t.data.data}):this.setState({options:[]});case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return f.a.createElement(N.a.Control,{as:"select",className:"global-select",onChange:function(t){e.props.setGlobalOption(e.props.parameter.value,t.target.value),t.preventDefault(),t.stopPropagation()},custom:!0},f.a.createElement("option",{value:""},this.props.parameter.label),this.state.options.map((function(e,t){var r=e.id,n=e.name,a=e.value,o=e.label;return f.a.createElement("option",{key:t,value:a||r},o||n)})))}}]),n}(Component);r(130);function _e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function He(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Object(y.registerLocale)("ru",k.a),Object(y.setDefaultLocale)("ru");t.default=function(e){var t=e.id,r=e.settings,n=e.globalParameter,o=(new Date).setFullYear((new Date).getFullYear()-1),l=(new Date).getTime(),u=Object(m.useState)([]),p=s()(u,2),g=p[0],b=p[1],y=Object(m.useState)(!1),E=s()(y,2),w=E[0],D=E[1],k=Object(m.useState)(o),C=s()(k,2),x=C[0],N=C[1],T=Object(m.useState)(l),q=s()(T,2),W=q[0],I=q[1],M=screen.width<=480,G=function(){var e=i()(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P()("/ajax/dashboards/".concat(t,"/settings"),{headers:[{key:"Cache-Control",value:"no-store"}]});case 3:if(200!==(r=e.sent).status){e.next=9;break}return console.log("req.data :>> ",r.data),e.abrupt("return",JSON.parse(r.data.settings));case 9:return e.abrupt("return",{});case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",{});case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=i()(d.a.mark((function e(t){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P()("/ajax/dashboards/".concat(t),{headers:[{key:"Cache-Control",value:"no-store"}]});case 3:if(200!==(r=e.sent).status){e.next=9;break}return console.log("req.data DASHBOARDS:>> ",r.data),e.abrupt("return",r.data);case 9:return e.abrupt("return",[]);case 10:e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),L=Object(m.useCallback)(function(){var e=i()(d.a.mark((function e(t,n,a){var o,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J(t);case 3:return o=e.sent,e.next=6,G(t);case 6:null!==(c=e.sent)&&c.hasOwnProperty("startDate")&&c.hasOwnProperty("endDate")?(b(o.map((function(e){return He(He({},e),{},{options:He(He({},JSON.parse(e.options)),{},{animated:r.animated}),filter:He(He({},JSON.parse(e.filter)),c)})}))),N(c.startDate),I(c.endDate)):(b(o.map((function(e){return He(He({},e),{},{options:He(He({},JSON.parse(e.options)),{},{animated:r.animated}),filter:He(He({},JSON.parse(e.filter)),{},{startDate:n,endDate:a})})}))),P.a.post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:n,endDate:a}},{headers:[{key:"Cache-Control",value:"no-store"}]})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r,n){return e.apply(this,arguments)}}(),[t,r.animated,x,W]),F=function(e){b(g.filter((function(t){return t.id!==e.id}))),P.a.delete("/ajax/dashboards/".concat(e.id),{headers:[{key:"Cache-Control",value:"no-store"}]})},R=function(e){b(g.map((function(t){return t.id===e.id?e:t}))),P.a.put("/ajax/dashboards/".concat(e.id),He(He({},e),{},{options:JSON.stringify(e.options),filter:JSON.stringify(e.filter)}),{headers:[{key:"Cache-Control",value:"no-store"}]})},B=function(e){N(e.getTime()),P.a.post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:e.getTime(),endDate:W}},{headers:[{key:"Cache-Control",value:"no-store"}]})},Y=function(e){I(e.getTime()),P.a.post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:x,endDate:e.getTime()}},{headers:[{key:"Cache-Control",value:"no-store"}]})},A=function(){var e=j()(W,{weeks:1}).getTime();N(e),P.a.post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:e,endDate:W}},{headers:[{key:"Cache-Control",value:"no-store"}]})},V=function(){var e=j()(W,{months:1}).getTime();N(e),P.a.post("/ajax/dashboards/".concat(t,"/settings"),{settings:{startDate:e,endDate:W}},{headers:[{key:"Cache-Control",value:"no-store"}]})},_=function(e,t){b(g.map((function(r){return He(He({},r),{},{filter:He(He({},r.filter),{},c()({},e,t))})})))};return Object(m.useEffect)((function(){L(t,x,W)}),[t,x,W]),f.a.createElement("div",{className:"altrp-dashboard"},f.a.createElement("div",{className:"altrp-dashboard__controls"},M?f.a.createElement(v.a,null,f.a.createElement(v.a.Toggle,{variant:"light"},f.a.createElement(S.a,{color:"#7a7a7b"})),f.a.createElement(v.a.Menu,null,f.a.createElement(v.a.Item,{onClick:function(){return D(!0)}},"Добавить виджет"),f.a.createElement(v.a.Divider,null),f.a.createElement(v.a.Item,{onClick:A},"Неделя"),f.a.createElement(v.a.Item,{onClick:V},"Месяц"),f.a.createElement(v.a.Divider,null),f.a.createElement(v.a.ItemText,{as:"div"},f.a.createElement(h.a,{closeOnScroll:!0,className:"form-control first",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:x,selectsStart:!0,onChange:B,dateFormat:"dd.MM.yyyy",showYearDropdown:!0})),f.a.createElement(v.a.ItemText,{as:"div"},f.a.createElement(h.a,{closeOnScroll:!0,className:"form-control last",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:W,minDate:x,selectsEnd:!0,onChange:Y,dateFormat:"dd.MM.yyyy",showYearDropdown:!0})),f.a.createElement(v.a.Divider,null),n&&n.map((function(e,t){return f.a.createElement(v.a.Item,{onClick:function(e){e.stopPropagation(),e.preventDefault()},key:t},f.a.createElement(Ve,{settings:r,setGlobalOption:_,parameter:e}))})))):f.a.createElement(O.a,{className:"jusitfy-content-end"},f.a.createElement(O.a.Item,{className:"nav-button",onClick:function(){return D(!0)}},"Добавить виджет"),f.a.createElement(O.a.Item,{className:"nav-datepickers"},f.a.createElement("div",{className:"nav-datepicker"},f.a.createElement(h.a,{closeOnScroll:!0,className:"form-control first",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:x,selectsStart:!0,onChange:B,dateFormat:"dd.MM.yyyy",showYearDropdown:!0})),f.a.createElement("div",{className:"nav-datepicker"},f.a.createElement(h.a,{closeOnScroll:!0,className:"form-control last",popperClassName:"datepicker-popper-mobile",popperPlacement:"bottom-end",selected:W,minDate:x,selectsEnd:!0,onChange:Y,dateFormat:"dd.MM.yyyy",showYearDropdown:!0}))),f.a.createElement(O.a.Item,{className:"nav-button",onClick:A},"Неделя"),f.a.createElement(O.a.Item,{className:"nav-button",onClick:V},"Месяц"),n&&n.map((function(e,t){return f.a.createElement(O.a.Item,{key:t},f.a.createElement(Ve,{settings:r,setGlobalOption:_,parameter:e}))})))),f.a.createElement("div",{className:"altrp-dashboard__widgets"},w&&f.a.createElement(ge,{settings:r,id:t,setIsShow:D,onAdd:function(e){b([e].concat(a()(g)))}}),g.map((function(e){return f.a.createElement(qe,{settings:r,key:e.id,widget:e,onDeleted:F,onEdited:R,isMobile:M})}))))}}};