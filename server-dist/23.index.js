exports.ids=[23],exports.modules={210:function(e,t,n){"use strict";n.r(t);var r=n(9),a=n.n(r),o=n(17),i=n.n(o),u=n(2),c=n.n(u),l=n(0),s=n.n(l),p=n(76),d=n.n(p),f=n(19),v=n(6),b=s.a.lazy((function(){return n.e(9).then(n.bind(null,173))}));t.default=function(e){var t=e.settings,n=e.id,r=Object(l.useState)(!1),o=i()(r,2),u=o[0],p=o[1],g=Object(l.useState)({}),y=i()(g,2),m=y[0],h=y[1],k=t.editable,x=t.canvas,O=t.zoom,j=t.lat,C=t.lng,D=t.latDs,S=t.lngDs,w=t.centerByDatasource,B=void 0!==w&&w,F=t.style_height,N=void 0===F?{}:F,z=t.style_margin,E=void 0===z?{}:z,K=t.objects,M=void 0===K?{}:K,P=t.url,q=t.field_id,L=t.url_connect,A=void 0===L?null:L,G=t.field_first_connect,H=void 0===G?null:G,J=t.field_second_connect,I=void 0===J?null:J,R=t.onlyDatasource,T=void 0!==R&&R,Q=t.parameters,U=j,V=C,W=Object(f.useSelector)((function(e){return e.currentDataStorage.data}));B&&(U=Object(v.q)(D,50.7496449),V=Object(v.q)(S,86.1250068));var X=Object(l.useMemo)(a()(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get(P);case 2:return t=e.sent,n=t.data.data.map((function(e){var t=_.get(e,"id"),n=JSON.parse(_.get(e,q));return n.dbID=t,n})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)}))),[P,q]),Y=Object(l.useMemo)((function(){if(_.keys(M).length>0)return M.map((function(e){var t,n=Object(v.q)(e.path,[]);return Array.isArray(n)?n.map((function(t){var n;return{type:"Feature",geometry:{type:"Point",coordinates:[Number(_.get(t,e.latitude)),Number(_.get(t,e.longitude))]},id:t.id,inCluster:(null==e?void 0:e.useCluster)||!1,properties:{fillOpacity:1,icon:e.icon||"GoogleMarker",tooltip:e.tooltipByKeyboard?e.tooltip:_.get(t,e.tooltip)||"",popup:e.popupByKeyboard?e.popup:_.get(t,e.popup)||"",fillColor:(null===(n=e.color)||void 0===n?void 0:n.colorPickedHex)||"#3388ff"}}})):{type:"Feature",geometry:{type:"Point",coordinates:[Number(_.get(n,e.latitude)),Number(_.get(n,e.longitude))]},id:n.id,inCluster:(null==e?void 0:e.useCluster)||!1,properties:{fillOpacity:1,icon:e.icon||"GoogleMarker",tooltip:e.tooltipByKeyboard?e.tooltip:_.get(n,e.tooltip)||"",popup:e.popupByKeyboard?e.popup:_.get(n,e.popup)||"",fillColor:(null===(t=e.color)||void 0===t?void 0:t.colorPickedHex)||"#3388ff"}}})).flat()}),[M,W]),Z=Object(l.useCallback)(function(){var e=a()(c.a.mark((function e(t,n){var r,a,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!T){e.next=6;break}h({type:"FeatureCollection",features:n}),p(!1),e.next=19;break;case 6:return e.prev=6,p(!0),e.next=10,d()("/ajax/maps/".concat(t));case 10:200===(r=e.sent).status&&(a=_.cloneDeep(r.data),o=[],i=a.features,_.keys(n).length>0&&(o=i.concat(n)),r.data.features=o.length>0?o:i,h(r.data),p(!1)),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(6),h({type:"FeatureCollection",features:n}),p(!1);case 19:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,n){return e.apply(this,arguments)}}(),[n]),$=Object(l.useCallback)(function(){var e=a()(c.a.mark((function e(t,n){var r,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===P){e.next=17;break}return e.prev=1,p(!0),e.next=5,t;case 5:r=e.sent,a=n,o=(o=r).concat(a).filter((function(e){return void 0!==e})),h({type:"FeatureCollection",features:o}),p(!1),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(1);case 15:e.next=18;break;case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}(),[P]);return Object(l.useEffect)((function(){void 0!==P&&""!=P&&null!==P?$(X,Y):Z(n,Y)}),[n,Y]),s.a.createElement(l.Suspense,{fallback:"Loading"},s.a.createElement(b,{data:m,saveData:function(e){T||null==P&&d.a.post("/ajax/maps/".concat(n),{data:JSON.stringify({type:"FeatureCollection",features:e.features.filter((function(e){return void 0!==e.id}))})})},isLoading:u,id:n,url_connect:A,field_first_connect:H,field_second_connect:I,style:{height:N.size+N.unit,marginTop:E.top+E.unit,marginBottom:E.bottom+E.unit,marginLeft:E.left+E.unit,marginRight:E.right+E.unit},isEditable:k,preferCanvas:x,zoom:+O,url:P,field_id:q,center:[U||50.7496449,V||86.1250068],parameters:Q}))}}};